{"backend_state":"running","connection_file":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/.local/share/jupyter/runtime/kernel-576e8f28-a5ae-456f-9a22-f83f8e0e782a.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1660929770631,"exec_count":122,"id":"706a0b","input":"import pandas as pd\nimport numpy as np\nimport sklearn\n\nfrom sklearn.model_selection import train_test_split\n","kernel":"ds_env","pos":0,"start":1660929770623,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929771440,"exec_count":123,"id":"95eb17","input":"df = pd.read_csv('diabetes_data_upload.csv')","kernel":"ds_env","pos":1,"start":1660929771425,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929772484,"exec_count":124,"id":"34fddf","input":"df.head()","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n      <th>class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>58</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>41</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>45</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>60</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   Age Gender Polyuria Polydipsia sudden weight loss weakness Polyphagia  \\\n0   40   Male       No        Yes                 No      Yes         No   \n1   58   Male       No         No                 No      Yes         No   \n2   41   Male      Yes         No                 No      Yes        Yes   \n3   45   Male       No         No                Yes      Yes        Yes   \n4   60   Male      Yes        Yes                Yes      Yes        Yes   \n\n  Genital thrush visual blurring Itching Irritability delayed healing  \\\n0             No              No     Yes           No             Yes   \n1             No             Yes      No           No              No   \n2             No              No     Yes           No             Yes   \n3            Yes              No     Yes           No             Yes   \n4             No             Yes     Yes          Yes             Yes   \n\n  partial paresis muscle stiffness Alopecia Obesity     class  \n0              No              Yes      Yes     Yes  Positive  \n1             Yes               No      Yes      No  Positive  \n2              No              Yes      Yes      No  Positive  \n3              No               No       No      No  Positive  \n4             Yes              Yes      Yes     Yes  Positive  "},"exec_count":124}},"pos":2,"start":1660929772470,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929774016,"exec_count":125,"id":"5c10c9","input":"#researching different columns and symptoms of diabetes, what makes a person diabetic?\n# Partial Paresis is a condition in which some muscle movement is weakened. Unlike paralysis, individuals with paresis still have some control over the affected muscles. Paresis occurs due to nerve damage, which can be caused by a variety of factors or conditions. Paresis refers to a condition in which muscle movement has become weakened or impaired. A vast network of nerves controls the movement of the muscles in our bodies. If a part of this network is damaged, muscles in the affected area may not work properly. There are several factors that can cause paresis, and there are many different types of paresis. Paresis is often categorized by the area of the body that’s impacted. Paresis is characterized by muscle weakness. A person with paresis can still move the affected muscle or muscles. However, these movements are weaker than normal. You may also see paresis used as a suffix to distinguish what part of the body is affected. For example, a person with monoparesis has muscle weakness affecting one limb.\n# Alopecia is a disease that happens when the immune system attacks hair follicles and causes hair loss. Hair follicles are the structures in skin that form hair. While hair can be lost from any part of the body, alopecia areata usually affects the head and face. Hair typically falls out in small, round patches about the size of a quarter, but in some cases, hair loss is more extensive. Most people with the disease are healthy and have no other symptoms. The course of alopecia areata varies from person to person. Some have bouts of hair loss throughout their lives, while others only have one episode. Recovery is unpredictable too, with hair regrowing fully in some people but not others. There is no cure for alopecia areata, but there are treatments that help hair grow back more quickly. Anyone can have alopecia areata. Men and women get it equally, and it affects all racial and ethnic groups. The onset can be at any age, but most people get it in their teens, twenties, or thirties. When it occurs in children younger than age 10, it tends to be more extensive and progressive. If you have a close family member with the disease, you may have a higher risk of getting it, but for many people, there is no family history. Scientists have linked a number of genes to the disease, which suggests that genetics play a role in alopecia areata. Many of the genes they have found are important for the functioning of the immune system. People with certain autoimmune diseases, such as psoriasis, thyroid disease, or vitiligo, are more likely to get alopecia areata, as are those with allergic conditions such as hay fever. It is possible that emotional stress or an illness can bring on alopecia areata in people who are at risk, but in most cases, there is no obvious trigger. There are three main types of alopecia areata: Patchy alopecia areata. In this type, which is the most common, hair loss happens in one or more coin-sized patches on the scalp or other parts of the body.Alopecia totalis. People with this type lose all or nearly all of the hair on their scalp. Alopecia universalis. In this type, which is rare, there is a complete or nearly complete loss of hair on the scalp, face, and rest of the body.","kernel":"ds_env","pos":3,"start":1660929774011,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929774866,"exec_count":126,"id":"aba686","input":"df['Age'].isnull().values.any()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"False"},"exec_count":126}},"pos":4,"start":1660929774817,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929775437,"exec_count":127,"id":"e3509b","input":"results=[]\nfor col in df.columns:\n        missing_or_not=df[col].isnull().values.any()\n        print(col+\":\"+str(missing_or_not))","kernel":"ds_env","output":{"0":{"name":"stdout","text":"Age:False\nGender:False\nPolyuria:False\nPolydipsia:False\nsudden weight loss:False\nweakness:False\nPolyphagia:False\nGenital thrush:False\nvisual blurring:False\nItching:False\nIrritability:False\ndelayed healing:False\npartial paresis:False\nmuscle stiffness:False\nAlopecia:False\nObesity:False\nclass:False\n"}},"pos":5,"scrolled":true,"start":1660929775423,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929776319,"exec_count":128,"id":"dc6688","input":"\n#create a function that takes in Yes or No as an argument, yes and no are going to be in a string format, if yes then return 1, if no then return 0","kernel":"ds_env","pos":6,"start":1660929776311,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929776327,"exec_count":129,"id":"9154ec","input":"def convert(x):\n    if x=='Yes':\n        return 1\n    else:\n        return 0","kernel":"ds_env","pos":7,"start":1660929776323,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929776710,"exec_count":130,"id":"179a93","input":"\nconvert('Yes')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1"},"exec_count":130}},"pos":8,"start":1660929776698,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929777370,"exec_count":131,"id":"436a76","input":"import plotly.express as px","kernel":"ds_env","pos":9,"start":1660929777367,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929778104,"exec_count":132,"id":"9d7fde","input":"fig=px.histogram(df, x='weakness', color='class', barmode='group')\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"875172e4f07c5cad874d30d4655f66113f7d6afe"}}},"pos":10,"start":1660929778031,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929779292,"exec_count":133,"id":"961a0b","input":"fig=px.histogram(df, x='delayed healing', color='class', barmode='group')\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"8dd12de582b81b721f511711cf78e8e8772babb2"}}},"pos":11,"start":1660929779216,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929779364,"exec_count":134,"id":"7dbab0","input":"fig=px.histogram(df, x='Alopecia', color='class', barmode='group')\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"2aa7534409f7661b213ea5643c9a8aea209d581a"}}},"pos":12,"start":1660929779300,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929779558,"exec_count":135,"id":"4fbc83","input":"def convert(x):\n    if x=='Yes' or x=='Male' or x=='Positive':\n        return 1\n    else:\n        return 0","kernel":"ds_env","pos":13,"start":1660929779548,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929779864,"exec_count":136,"id":"e77c3d","input":"for col in df.columns:\n    if col !='Age':\n        df[col] = df[col].apply(convert)","kernel":"ds_env","pos":14,"start":1660929779845,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929780694,"exec_count":137,"id":"0c0be0","input":"df.head()","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n      <th>class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>58</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>41</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>45</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>60</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   Age  Gender  Polyuria  Polydipsia  sudden weight loss  weakness  \\\n0   40       1         0           1                   0         1   \n1   58       1         0           0                   0         1   \n2   41       1         1           0                   0         1   \n3   45       1         0           0                   1         1   \n4   60       1         1           1                   1         1   \n\n   Polyphagia  Genital thrush  visual blurring  Itching  Irritability  \\\n0           0               0                0        1             0   \n1           0               0                1        0             0   \n2           1               0                0        1             0   \n3           1               1                0        1             0   \n4           1               0                1        1             1   \n\n   delayed healing  partial paresis  muscle stiffness  Alopecia  Obesity  \\\n0                1                0                 1         1        1   \n1                0                1                 0         1        0   \n2                1                0                 1         1        0   \n3                1                0                 0         0        0   \n4                1                1                 1         1        1   \n\n   class  \n0      1  \n1      1  \n2      1  \n3      1  \n4      1  "},"exec_count":137}},"pos":15,"scrolled":true,"start":1660929780677,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929783057,"exec_count":138,"id":"97a55d","input":"x = df.drop(['class'], axis = 1)\ny = df['class']","kernel":"ds_env","pos":16,"start":1660929783049,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929783082,"exec_count":139,"id":"9ad1c1","input":"x","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>58</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>41</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>45</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>60</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>515</th>\n      <td>39</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>516</th>\n      <td>48</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>517</th>\n      <td>58</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>518</th>\n      <td>32</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>519</th>\n      <td>42</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>520 rows × 16 columns</p>\n</div>","text/plain":"     Age  Gender  Polyuria  Polydipsia  sudden weight loss  weakness  \\\n0     40       1         0           1                   0         1   \n1     58       1         0           0                   0         1   \n2     41       1         1           0                   0         1   \n3     45       1         0           0                   1         1   \n4     60       1         1           1                   1         1   \n..   ...     ...       ...         ...                 ...       ...   \n515   39       0         1           1                   1         0   \n516   48       0         1           1                   1         1   \n517   58       0         1           1                   1         1   \n518   32       0         0           0                   0         1   \n519   42       1         0           0                   0         0   \n\n     Polyphagia  Genital thrush  visual blurring  Itching  Irritability  \\\n0             0               0                0        1             0   \n1             0               0                1        0             0   \n2             1               0                0        1             0   \n3             1               1                0        1             0   \n4             1               0                1        1             1   \n..          ...             ...              ...      ...           ...   \n515           1               0                0        1             0   \n516           1               0                0        1             1   \n517           1               0                1        0             0   \n518           0               0                1        1             0   \n519           0               0                0        0             0   \n\n     delayed healing  partial paresis  muscle stiffness  Alopecia  Obesity  \n0                  1                0                 1         1        1  \n1                  0                1                 0         1        0  \n2                  1                0                 1         1        0  \n3                  1                0                 0         0        0  \n4                  1                1                 1         1        1  \n..               ...              ...               ...       ...      ...  \n515                1                1                 0         0        0  \n516                1                1                 0         0        0  \n517                0                1                 1         0        1  \n518                1                0                 0         1        0  \n519                0                0                 0         0        0  \n\n[520 rows x 16 columns]"},"exec_count":139}},"pos":17,"start":1660929783060,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929785037,"exec_count":140,"id":"278b8b","input":"\nx.corrwith(y)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\ndtype: float64"},"exec_count":140}},"pos":18,"start":1660929785018,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929785114,"exec_count":141,"id":"2f2072","input":"df.corr()","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n      <th>class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Age</th>\n      <td>1.000000</td>\n      <td>0.062872</td>\n      <td>0.199781</td>\n      <td>0.137382</td>\n      <td>0.064808</td>\n      <td>0.224596</td>\n      <td>0.315577</td>\n      <td>0.096519</td>\n      <td>0.402729</td>\n      <td>0.296559</td>\n      <td>0.201625</td>\n      <td>0.257501</td>\n      <td>0.232742</td>\n      <td>0.307703</td>\n      <td>0.321691</td>\n      <td>0.140458</td>\n      <td>0.108679</td>\n    </tr>\n    <tr>\n      <th>Gender</th>\n      <td>0.062872</td>\n      <td>1.000000</td>\n      <td>-0.268894</td>\n      <td>-0.312262</td>\n      <td>-0.281840</td>\n      <td>-0.124490</td>\n      <td>-0.219968</td>\n      <td>0.208961</td>\n      <td>-0.208092</td>\n      <td>-0.052496</td>\n      <td>-0.013735</td>\n      <td>-0.101978</td>\n      <td>-0.332288</td>\n      <td>-0.090542</td>\n      <td>0.327871</td>\n      <td>-0.005396</td>\n      <td>-0.449233</td>\n    </tr>\n    <tr>\n      <th>Polyuria</th>\n      <td>0.199781</td>\n      <td>-0.268894</td>\n      <td>1.000000</td>\n      <td>0.598609</td>\n      <td>0.447207</td>\n      <td>0.263000</td>\n      <td>0.373873</td>\n      <td>0.087273</td>\n      <td>0.235095</td>\n      <td>0.088289</td>\n      <td>0.237740</td>\n      <td>0.149873</td>\n      <td>0.441664</td>\n      <td>0.152938</td>\n      <td>-0.144192</td>\n      <td>0.126567</td>\n      <td>0.665922</td>\n    </tr>\n    <tr>\n      <th>Polydipsia</th>\n      <td>0.137382</td>\n      <td>-0.312262</td>\n      <td>0.598609</td>\n      <td>1.000000</td>\n      <td>0.405965</td>\n      <td>0.332453</td>\n      <td>0.316839</td>\n      <td>0.028081</td>\n      <td>0.331250</td>\n      <td>0.128716</td>\n      <td>0.203446</td>\n      <td>0.115691</td>\n      <td>0.442249</td>\n      <td>0.180723</td>\n      <td>-0.310964</td>\n      <td>0.098691</td>\n      <td>0.648734</td>\n    </tr>\n    <tr>\n      <th>sudden weight loss</th>\n      <td>0.064808</td>\n      <td>-0.281840</td>\n      <td>0.447207</td>\n      <td>0.405965</td>\n      <td>1.000000</td>\n      <td>0.282884</td>\n      <td>0.243511</td>\n      <td>0.089858</td>\n      <td>0.068754</td>\n      <td>-0.004516</td>\n      <td>0.140340</td>\n      <td>0.088140</td>\n      <td>0.264014</td>\n      <td>0.109756</td>\n      <td>-0.202727</td>\n      <td>0.169294</td>\n      <td>0.436568</td>\n    </tr>\n    <tr>\n      <th>weakness</th>\n      <td>0.224596</td>\n      <td>-0.124490</td>\n      <td>0.263000</td>\n      <td>0.332453</td>\n      <td>0.282884</td>\n      <td>1.000000</td>\n      <td>0.180266</td>\n      <td>0.027780</td>\n      <td>0.301043</td>\n      <td>0.309440</td>\n      <td>0.146698</td>\n      <td>0.335507</td>\n      <td>0.272982</td>\n      <td>0.263164</td>\n      <td>0.090490</td>\n      <td>0.045665</td>\n      <td>0.243275</td>\n    </tr>\n    <tr>\n      <th>Polyphagia</th>\n      <td>0.315577</td>\n      <td>-0.219968</td>\n      <td>0.373873</td>\n      <td>0.316839</td>\n      <td>0.243511</td>\n      <td>0.180266</td>\n      <td>1.000000</td>\n      <td>-0.063712</td>\n      <td>0.293545</td>\n      <td>0.144390</td>\n      <td>0.239466</td>\n      <td>0.263980</td>\n      <td>0.373569</td>\n      <td>0.320031</td>\n      <td>-0.053498</td>\n      <td>0.029785</td>\n      <td>0.342504</td>\n    </tr>\n    <tr>\n      <th>Genital thrush</th>\n      <td>0.096519</td>\n      <td>0.208961</td>\n      <td>0.087273</td>\n      <td>0.028081</td>\n      <td>0.089858</td>\n      <td>0.027780</td>\n      <td>-0.063712</td>\n      <td>1.000000</td>\n      <td>-0.148408</td>\n      <td>0.125336</td>\n      <td>0.160551</td>\n      <td>0.136111</td>\n      <td>-0.195612</td>\n      <td>-0.100188</td>\n      <td>0.204847</td>\n      <td>0.053828</td>\n      <td>0.110288</td>\n    </tr>\n    <tr>\n      <th>visual blurring</th>\n      <td>0.402729</td>\n      <td>-0.208092</td>\n      <td>0.235095</td>\n      <td>0.331250</td>\n      <td>0.068754</td>\n      <td>0.301043</td>\n      <td>0.293545</td>\n      <td>-0.148408</td>\n      <td>1.000000</td>\n      <td>0.291191</td>\n      <td>0.077095</td>\n      <td>0.177767</td>\n      <td>0.364156</td>\n      <td>0.412369</td>\n      <td>0.014604</td>\n      <td>0.109005</td>\n      <td>0.251300</td>\n    </tr>\n    <tr>\n      <th>Itching</th>\n      <td>0.296559</td>\n      <td>-0.052496</td>\n      <td>0.088289</td>\n      <td>0.128716</td>\n      <td>-0.004516</td>\n      <td>0.309440</td>\n      <td>0.144390</td>\n      <td>0.125336</td>\n      <td>0.291191</td>\n      <td>1.000000</td>\n      <td>0.114006</td>\n      <td>0.453316</td>\n      <td>0.116669</td>\n      <td>0.215575</td>\n      <td>0.266506</td>\n      <td>0.001894</td>\n      <td>-0.013384</td>\n    </tr>\n    <tr>\n      <th>Irritability</th>\n      <td>0.201625</td>\n      <td>-0.013735</td>\n      <td>0.237740</td>\n      <td>0.203446</td>\n      <td>0.140340</td>\n      <td>0.146698</td>\n      <td>0.239466</td>\n      <td>0.160551</td>\n      <td>0.077095</td>\n      <td>0.114006</td>\n      <td>1.000000</td>\n      <td>0.126877</td>\n      <td>0.151571</td>\n      <td>0.201637</td>\n      <td>0.043708</td>\n      <td>0.127801</td>\n      <td>0.299467</td>\n    </tr>\n    <tr>\n      <th>delayed healing</th>\n      <td>0.257501</td>\n      <td>-0.101978</td>\n      <td>0.149873</td>\n      <td>0.115691</td>\n      <td>0.088140</td>\n      <td>0.335507</td>\n      <td>0.263980</td>\n      <td>0.136111</td>\n      <td>0.177767</td>\n      <td>0.453316</td>\n      <td>0.126877</td>\n      <td>1.000000</td>\n      <td>0.187382</td>\n      <td>0.250078</td>\n      <td>0.290179</td>\n      <td>-0.066339</td>\n      <td>0.046980</td>\n    </tr>\n    <tr>\n      <th>partial paresis</th>\n      <td>0.232742</td>\n      <td>-0.332288</td>\n      <td>0.441664</td>\n      <td>0.442249</td>\n      <td>0.264014</td>\n      <td>0.272982</td>\n      <td>0.373569</td>\n      <td>-0.195612</td>\n      <td>0.364156</td>\n      <td>0.116669</td>\n      <td>0.151571</td>\n      <td>0.187382</td>\n      <td>1.000000</td>\n      <td>0.232634</td>\n      <td>-0.221576</td>\n      <td>-0.009401</td>\n      <td>0.432288</td>\n    </tr>\n    <tr>\n      <th>muscle stiffness</th>\n      <td>0.307703</td>\n      <td>-0.090542</td>\n      <td>0.152938</td>\n      <td>0.180723</td>\n      <td>0.109756</td>\n      <td>0.263164</td>\n      <td>0.320031</td>\n      <td>-0.100188</td>\n      <td>0.412369</td>\n      <td>0.215575</td>\n      <td>0.201637</td>\n      <td>0.250078</td>\n      <td>0.232634</td>\n      <td>1.000000</td>\n      <td>0.040758</td>\n      <td>0.158910</td>\n      <td>0.122474</td>\n    </tr>\n    <tr>\n      <th>Alopecia</th>\n      <td>0.321691</td>\n      <td>0.327871</td>\n      <td>-0.144192</td>\n      <td>-0.310964</td>\n      <td>-0.202727</td>\n      <td>0.090490</td>\n      <td>-0.053498</td>\n      <td>0.204847</td>\n      <td>0.014604</td>\n      <td>0.266506</td>\n      <td>0.043708</td>\n      <td>0.290179</td>\n      <td>-0.221576</td>\n      <td>0.040758</td>\n      <td>1.000000</td>\n      <td>0.029229</td>\n      <td>-0.267512</td>\n    </tr>\n    <tr>\n      <th>Obesity</th>\n      <td>0.140458</td>\n      <td>-0.005396</td>\n      <td>0.126567</td>\n      <td>0.098691</td>\n      <td>0.169294</td>\n      <td>0.045665</td>\n      <td>0.029785</td>\n      <td>0.053828</td>\n      <td>0.109005</td>\n      <td>0.001894</td>\n      <td>0.127801</td>\n      <td>-0.066339</td>\n      <td>-0.009401</td>\n      <td>0.158910</td>\n      <td>0.029229</td>\n      <td>1.000000</td>\n      <td>0.072173</td>\n    </tr>\n    <tr>\n      <th>class</th>\n      <td>0.108679</td>\n      <td>-0.449233</td>\n      <td>0.665922</td>\n      <td>0.648734</td>\n      <td>0.436568</td>\n      <td>0.243275</td>\n      <td>0.342504</td>\n      <td>0.110288</td>\n      <td>0.251300</td>\n      <td>-0.013384</td>\n      <td>0.299467</td>\n      <td>0.046980</td>\n      <td>0.432288</td>\n      <td>0.122474</td>\n      <td>-0.267512</td>\n      <td>0.072173</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"                         Age    Gender  Polyuria  Polydipsia  \\\nAge                 1.000000  0.062872  0.199781    0.137382   \nGender              0.062872  1.000000 -0.268894   -0.312262   \nPolyuria            0.199781 -0.268894  1.000000    0.598609   \nPolydipsia          0.137382 -0.312262  0.598609    1.000000   \nsudden weight loss  0.064808 -0.281840  0.447207    0.405965   \nweakness            0.224596 -0.124490  0.263000    0.332453   \nPolyphagia          0.315577 -0.219968  0.373873    0.316839   \nGenital thrush      0.096519  0.208961  0.087273    0.028081   \nvisual blurring     0.402729 -0.208092  0.235095    0.331250   \nItching             0.296559 -0.052496  0.088289    0.128716   \nIrritability        0.201625 -0.013735  0.237740    0.203446   \ndelayed healing     0.257501 -0.101978  0.149873    0.115691   \npartial paresis     0.232742 -0.332288  0.441664    0.442249   \nmuscle stiffness    0.307703 -0.090542  0.152938    0.180723   \nAlopecia            0.321691  0.327871 -0.144192   -0.310964   \nObesity             0.140458 -0.005396  0.126567    0.098691   \nclass               0.108679 -0.449233  0.665922    0.648734   \n\n                    sudden weight loss  weakness  Polyphagia  Genital thrush  \\\nAge                           0.064808  0.224596    0.315577        0.096519   \nGender                       -0.281840 -0.124490   -0.219968        0.208961   \nPolyuria                      0.447207  0.263000    0.373873        0.087273   \nPolydipsia                    0.405965  0.332453    0.316839        0.028081   \nsudden weight loss            1.000000  0.282884    0.243511        0.089858   \nweakness                      0.282884  1.000000    0.180266        0.027780   \nPolyphagia                    0.243511  0.180266    1.000000       -0.063712   \nGenital thrush                0.089858  0.027780   -0.063712        1.000000   \nvisual blurring               0.068754  0.301043    0.293545       -0.148408   \nItching                      -0.004516  0.309440    0.144390        0.125336   \nIrritability                  0.140340  0.146698    0.239466        0.160551   \ndelayed healing               0.088140  0.335507    0.263980        0.136111   \npartial paresis               0.264014  0.272982    0.373569       -0.195612   \nmuscle stiffness              0.109756  0.263164    0.320031       -0.100188   \nAlopecia                     -0.202727  0.090490   -0.053498        0.204847   \nObesity                       0.169294  0.045665    0.029785        0.053828   \nclass                         0.436568  0.243275    0.342504        0.110288   \n\n                    visual blurring   Itching  Irritability  delayed healing  \\\nAge                        0.402729  0.296559      0.201625         0.257501   \nGender                    -0.208092 -0.052496     -0.013735        -0.101978   \nPolyuria                   0.235095  0.088289      0.237740         0.149873   \nPolydipsia                 0.331250  0.128716      0.203446         0.115691   \nsudden weight loss         0.068754 -0.004516      0.140340         0.088140   \nweakness                   0.301043  0.309440      0.146698         0.335507   \nPolyphagia                 0.293545  0.144390      0.239466         0.263980   \nGenital thrush            -0.148408  0.125336      0.160551         0.136111   \nvisual blurring            1.000000  0.291191      0.077095         0.177767   \nItching                    0.291191  1.000000      0.114006         0.453316   \nIrritability               0.077095  0.114006      1.000000         0.126877   \ndelayed healing            0.177767  0.453316      0.126877         1.000000   \npartial paresis            0.364156  0.116669      0.151571         0.187382   \nmuscle stiffness           0.412369  0.215575      0.201637         0.250078   \nAlopecia                   0.014604  0.266506      0.043708         0.290179   \nObesity                    0.109005  0.001894      0.127801        -0.066339   \nclass                      0.251300 -0.013384      0.299467         0.046980   \n\n                    partial paresis  muscle stiffness  Alopecia   Obesity  \\\nAge                        0.232742          0.307703  0.321691  0.140458   \nGender                    -0.332288         -0.090542  0.327871 -0.005396   \nPolyuria                   0.441664          0.152938 -0.144192  0.126567   \nPolydipsia                 0.442249          0.180723 -0.310964  0.098691   \nsudden weight loss         0.264014          0.109756 -0.202727  0.169294   \nweakness                   0.272982          0.263164  0.090490  0.045665   \nPolyphagia                 0.373569          0.320031 -0.053498  0.029785   \nGenital thrush            -0.195612         -0.100188  0.204847  0.053828   \nvisual blurring            0.364156          0.412369  0.014604  0.109005   \nItching                    0.116669          0.215575  0.266506  0.001894   \nIrritability               0.151571          0.201637  0.043708  0.127801   \ndelayed healing            0.187382          0.250078  0.290179 -0.066339   \npartial paresis            1.000000          0.232634 -0.221576 -0.009401   \nmuscle stiffness           0.232634          1.000000  0.040758  0.158910   \nAlopecia                  -0.221576          0.040758  1.000000  0.029229   \nObesity                   -0.009401          0.158910  0.029229  1.000000   \nclass                      0.432288          0.122474 -0.267512  0.072173   \n\n                       class  \nAge                 0.108679  \nGender             -0.449233  \nPolyuria            0.665922  \nPolydipsia          0.648734  \nsudden weight loss  0.436568  \nweakness            0.243275  \nPolyphagia          0.342504  \nGenital thrush      0.110288  \nvisual blurring     0.251300  \nItching            -0.013384  \nIrritability        0.299467  \ndelayed healing     0.046980  \npartial paresis     0.432288  \nmuscle stiffness    0.122474  \nAlopecia           -0.267512  \nObesity             0.072173  \nclass               1.000000  "},"exec_count":141}},"pos":19,"start":1660929785043,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929785143,"exec_count":142,"id":"10bfd8","input":"x.corrwith(y)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\ndtype: float64"},"exec_count":142}},"pos":20,"start":1660929785129,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929785183,"exec_count":143,"id":"798b8e","input":"corr = df.corr()\ncorr['class']","kernel":"ds_env","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\nclass                 1.000000\nName: class, dtype: float64"},"exec_count":143}},"pos":21,"start":1660929785149,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929786372,"exec_count":144,"id":"06305c","input":"corr = df.corr()\nfig = px.imshow(corr, aspect=\"auto\", color_continuous_scale='bupu', text_auto = True)\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"3613bc250198d4c13eeb251199bf998a02884c82"}}},"pos":22,"start":1660929786291,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929786474,"exec_count":145,"id":"089cc7","input":"px.bar(corr, x = 'class', color = 'class')","kernel":"ds_env","output":{"0":{"data":{"iframe":"10433bbb34248aa999e951c6253321162c2d8400"}}},"pos":23,"start":1660929786381,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929786593,"exec_count":146,"id":"e0efc3","input":"corr_data = x.corrwith(y).to_frame().reset_index()\nfig = px.bar(corr_data, x='index', y=0, title=\"Correlaiton between Features and Having Diabetes\")\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"26bfdef9d485528906d821a69b6c649cc54442cf"}}},"pos":24,"start":1660929786489,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929786964,"exec_count":147,"id":"b94643","input":"#Logistic Regression","kernel":"ds_env","pos":25,"start":1660929786960,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929786979,"exec_count":148,"id":"792cd1","input":"X = df.drop(['class','Age', 'weakness', 'Genital thrush', 'Itching', 'delayed healing', 'muscle stiffness', 'Obesity'], axis = 1)\nY = df['class']","kernel":"ds_env","pos":26,"start":1660929786969,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929787355,"exec_count":149,"id":"48b8e9","input":"X_train,X_test, y_train, y_test = train_test_split(X, y, random_state = 42)","kernel":"ds_env","pos":27,"start":1660929787330,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929787587,"exec_count":150,"id":"da2e93","input":"from sklearn.preprocessing import StandardScaler\nss = StandardScaler()\nX_train = ss.fit_transform(X_train)\nX_test = ss.transform(X_test)","kernel":"ds_env","pos":28,"start":1660929787577,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929788025,"exec_count":151,"id":"7607b2","input":"from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\nclf = LogisticRegression(random_state=0).fit(X, y)\ny_hat = clf.predict(X_test)","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/base.py:450: UserWarning:\n\nX does not have valid feature names, but LogisticRegression was fitted with feature names\n\n"}},"pos":29,"start":1660929788010,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929788383,"exec_count":152,"id":"811c84","input":"y_hat","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1,\n       1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1,\n       0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,\n       0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":152}},"pos":30,"start":1660929788367,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929788904,"exec_count":153,"id":"4d391e","input":"from sklearn.metrics import precision_score\nprecision_score(y_test,y_hat)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1.0"},"exec_count":153}},"pos":31,"start":1660929788892,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929789451,"exec_count":154,"id":"ba958d","input":"from sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8461538461538461"},"exec_count":154}},"pos":32,"start":1660929789431,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929792700,"exec_count":155,"id":"45bc22","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.15384615384615385\n"}},"pos":33,"start":1660929792686,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929792715,"exec_count":156,"id":"56f6ab","input":"from sklearn.metrics import recall_score\nrecall_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1.0"},"exec_count":156}},"pos":34,"start":1660929792706,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929792911,"exec_count":157,"id":"3be28b","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":157},"1":{"data":{"image/png":"2a8d317bc0d874bbc2f8a99d5d8864c9eb25bef7","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":35,"start":1660929792718,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929793103,"exec_count":158,"id":"184445","input":"#SVM Linear","kernel":"ds_env","pos":36,"start":1660929793090,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929793531,"exec_count":159,"id":"073c58","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification","kernel":"ds_env","pos":37,"start":1660929793528,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929795240,"exec_count":160,"id":"26318f","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nclf.fit(X, y)\n","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-7\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-17\" type=\"checkbox\" ><label for=\"sk-estimator-id-17\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-18\" type=\"checkbox\" ><label for=\"sk-estimator-id-18\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">StandardScaler</label><div class=\"sk-toggleable__content\"><pre>StandardScaler()</pre></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-19\" type=\"checkbox\" ><label for=\"sk-estimator-id-19\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC(random_state=0, tol=1e-05)</pre></div></div></div></div></div></div></div>","text/plain":"Pipeline(steps=[('standardscaler', StandardScaler()),\n                ('linearsvc', LinearSVC(random_state=0, tol=1e-05))])"},"exec_count":160}},"pos":38,"start":1660929795212,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929795289,"exec_count":161,"id":"481fe3","input":"y_hat = clf.predict(X_test)\ny_hat","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/base.py:450: UserWarning:\n\nX does not have valid feature names, but StandardScaler was fitted with feature names\n\n"},"1":{"data":{"text/plain":"array([0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1,\n       1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1,\n       0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,\n       0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":161}},"pos":39,"start":1660929795251,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929796701,"exec_count":162,"id":"0103c4","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.13846153846153847\n"}},"pos":41,"start":1660929796685,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929796713,"exec_count":163,"id":"e31814","input":"from sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8615384615384616"},"exec_count":163}},"pos":42,"start":1660929796705,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929796728,"exec_count":164,"id":"887f7c","input":"from sklearn.metrics import precision_score\nprecision_score(y_test,y_hat)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1.0"},"exec_count":164}},"pos":43,"start":1660929796717,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929797894,"exec_count":165,"id":"9f66d2","input":"from sklearn.metrics import recall_score\nrecall_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1.0"},"exec_count":165}},"pos":44,"start":1660929797881,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929798109,"exec_count":166,"id":"987acb","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":166},"1":{"data":{"image/png":"9220e980a8bdfdb7ebf301d9bfc49f029e7437fd","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":45,"start":1660929797901,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929798117,"exec_count":167,"id":"84d06a","input":"#KNN","kernel":"ds_env","pos":46,"start":1660929798114,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929798337,"exec_count":168,"id":"01c902","input":"import sklearn #our favorite machine learning library\nfrom sklearn.neighbors import KNeighborsClassifier as KNN #this will import our model as KNN\n","kernel":"ds_env","pos":47,"start":1660929798326,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929799352,"exec_count":169,"id":"253c81","input":"# Creating the KNN model object -- we need to tell it the number of neighbors to look at.\nk = 7 #number of neighbors to look at (look at 7 nearest neighbors)\nmy_KNN_model = KNN(n_neighbors=k)","kernel":"ds_env","pos":48,"start":1660929799340,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929800466,"exec_count":170,"id":"434b28","input":"my_KNN_model.fit(X_train, y_train) #train the model on our past results x_train (inputs) and y_train (outputs)\n","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-8 {color: black;background-color: white;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-8\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier(n_neighbors=7)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-20\" type=\"checkbox\" checked><label for=\"sk-estimator-id-20\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier(n_neighbors=7)</pre></div></div></div></div></div>","text/plain":"KNeighborsClassifier(n_neighbors=7)"},"exec_count":170}},"pos":49,"start":1660929800435,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929802643,"exec_count":171,"id":"b6495b","input":"y_hat = my_KNN_model.predict(X_test)\ny_hat","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1,\n       1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,\n       0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":171}},"pos":50,"start":1660929802624,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929802660,"exec_count":172,"id":"0f73c4","input":"np.array(y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1,\n       1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,\n       0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":172}},"pos":51,"start":1660929802648,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929802674,"exec_count":173,"id":"46d5f3","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.08461538461538462\n"}},"pos":52,"start":1660929802664,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929802697,"exec_count":174,"id":"2952af","input":"from sklearn.metrics import precision_score\nprecision_score(y_test,y_hat)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9620253164556962"},"exec_count":174}},"pos":53,"start":1660929802688,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929802720,"exec_count":175,"id":"86c0a0","input":"from sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9153846153846154"},"exec_count":175}},"pos":54,"start":1660929802706,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929803182,"exec_count":176,"id":"c9a4de","input":"from sklearn.metrics import recall_score\nrecall_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9620253164556962"},"exec_count":176}},"pos":55,"scrolled":true,"start":1660929803165,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929803629,"exec_count":177,"id":"716f06","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":177},"1":{"data":{"image/png":"6a50bda60ca188819bd423fe33c956c76967b09d","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":56,"start":1660929803448,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929803753,"exec_count":178,"id":"642530","input":"#SVM RBF","kernel":"ds_env","pos":57,"start":1660929803735,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929803921,"exec_count":179,"id":"1f7999","input":"from sklearn.datasets import load_iris\n\niris = load_iris()\nX = iris.data\ny = iris.target","kernel":"ds_env","pos":58,"start":1660929803908,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929804237,"exec_count":180,"id":"9b84a0","input":"X_2d = X[:, :2]\nX_2d = X_2d[y > 0]\ny_2d = y[y > 0]\ny_2d -= 1","kernel":"ds_env","pos":59,"start":1660929804227,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929804737,"exec_count":181,"id":"d1f443","input":"from sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\nX = scaler.fit_transform(X)\nX_2d = scaler.fit_transform(X_2d)","kernel":"ds_env","pos":60,"start":1660929804721,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929808993,"exec_count":182,"id":"30aa59","input":"from sklearn.svm import SVC\nfrom sklearn.model_selection import StratifiedShuffleSplit\nfrom sklearn.model_selection import GridSearchCV\n\nC_range = np.logspace(-2, 10, 13)\ngamma_range = np.logspace(-9, 3, 13)\nparam_grid = dict(gamma=gamma_range, C=C_range)\ncv = StratifiedShuffleSplit(n_splits=5, test_size=0.2, random_state=42)\ngrid = GridSearchCV(SVC(), param_grid=param_grid, cv=cv)\ngrid.fit(X, y)\n\nprint(\n    \"The best parameters are %s with a score of %0.2f\"\n    % (grid.best_params_, grid.best_score_)\n)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"The best parameters are {'C': 1.0, 'gamma': 0.1} with a score of 0.97\n"}},"pos":61,"start":1660929805197,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929809015,"exec_count":183,"id":"eaf148","input":"C_2d_range = [1e-2, 1, 1e2]\ngamma_2d_range = [1e-1, 1, 1e1]\nclassifiers = []\nfor C in C_2d_range:\n    for gamma in gamma_2d_range:\n        clf = SVC(C=C, gamma=gamma)\n        clf.fit(X_2d, y_2d)\n        classifiers.append((C, gamma, clf))","kernel":"ds_env","pos":62,"start":1660929808999,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929811326,"exec_count":184,"id":"eef26a","input":"import matplotlib.pyplot as plt\n\nplt.figure(figsize=(8, 6))\nxx, yy = np.meshgrid(np.linspace(-3, 3, 200), np.linspace(-3, 3, 200))\nfor k, (C, gamma, clf) in enumerate(classifiers):\n    # evaluate decision function in a grid\n    Z = clf.decision_function(np.c_[xx.ravel(), yy.ravel()])\n    Z = Z.reshape(xx.shape)\n\n    # visualize decision function for these parameters\n    plt.subplot(len(C_2d_range), len(gamma_2d_range), k + 1)\n    plt.title(\"gamma=10^%d, C=10^%d\" % (np.log10(gamma), np.log10(C)), size=\"medium\")\n\n    # visualize parameter's effect on decision function\n    plt.pcolormesh(xx, yy, -Z, cmap=plt.cm.RdBu)\n    plt.scatter(X_2d[:, 0], X_2d[:, 1], c=y_2d, cmap=plt.cm.RdBu_r, edgecolors=\"k\")\n    plt.xticks(())\n    plt.yticks(())\n    plt.axis(\"tight\")\n\nscores = grid.cv_results_[\"mean_test_score\"].reshape(len(C_range), len(gamma_range))","kernel":"ds_env","output":{"0":{"data":{"image/png":"3bec7aa20ffb0bfe02a6a1d04373df7e396e355b","text/plain":"<Figure size 576x432 with 9 Axes>"}}},"pos":63,"start":1660929809023,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929811337,"exec_count":185,"id":"f3517c","input":"from sklearn.metrics import precision_score\nprecision_score(y_test,y_hat)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9620253164556962"},"exec_count":185}},"pos":64,"start":1660929811333,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929852099,"exec_count":186,"id":"17f45c","input":"from sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9153846153846154"},"exec_count":186}},"pos":65,"start":1660929852070,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929852879,"exec_count":187,"id":"6d69ce","input":"from sklearn.metrics import recall_score\nrecall_score(y_hat, y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9620253164556962"},"exec_count":187}},"pos":66,"start":1660929852861,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929853911,"exec_count":188,"id":"5c5977","input":"import matplotlib.pyplot as plt\n\nplt.figure(figsize=(8, 6))\nxx, yy = np.meshgrid(np.linspace(-3, 3, 200), np.linspace(-3, 3, 200))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":188},"1":{"data":{"image/png":"bfbcc54bada60ed2fc081b8ebbeb90d230a293a0","text/plain":"<Figure size 576x432 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":67,"start":1660929853703,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929854303,"exec_count":189,"id":"cb1dd4","input":"import sklearn\nfrom sklearn.neighbors import KNeighborsClassifier as KNN\nfrom sklearn.model_selection import GridSearchCV","kernel":"ds_env","pos":68,"start":1660929854293,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929854739,"exec_count":190,"id":"96e4b1","input":"k=7\nparameters={'n_neighbors':[3,5,7], 'weights':('uniform', 'distance'), 'algorithm':('auto', 'ball_tree')}\nmy_KNN_model=KNN()","kernel":"ds_env","pos":69,"start":1660929854731,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929855991,"exec_count":191,"id":"c83da3","input":"clf=GridSearchCV(my_KNN_model, parameters)","kernel":"ds_env","pos":70,"start":1660929855978,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929856316,"exec_count":192,"id":"dad962","input":"clf.fit(X_train, y_train)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-9 {color: black;background-color: white;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-9\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-21\" type=\"checkbox\" ><label for=\"sk-estimator-id-21\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-22\" type=\"checkbox\" ><label for=\"sk-estimator-id-22\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-23\" type=\"checkbox\" ><label for=\"sk-estimator-id-23\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={'algorithm': ('auto', 'ball_tree'),\n                         'n_neighbors': [3, 5, 7],\n                         'weights': ('uniform', 'distance')})"},"exec_count":192}},"pos":71,"start":1660929855996,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929856510,"exec_count":193,"id":"04ca7b","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}"},"exec_count":193}},"pos":72,"start":1660929856496,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929857028,"exec_count":194,"id":"cad7b3","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9461538461538461"},"exec_count":194}},"pos":73,"scrolled":true,"start":1660929857003,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929858383,"exec_count":195,"id":"831282","input":"pred=clf.predict(X_test)","kernel":"ds_env","pos":74,"start":1660929858377,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929858404,"exec_count":196,"id":"6ba49a","input":"(pred==y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9461538461538461"},"exec_count":196}},"pos":75,"start":1660929858391,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929858960,"exec_count":197,"id":"d39173","input":"total_squared_error=(np.sum((y_test - pred)**2))\nmean_squared_error=total_squared_error/len(y_test)\nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.05384615384615385\n"}},"pos":76,"start":1660929858956,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929859462,"exec_count":198,"id":"933206","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, pred), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":198},"1":{"data":{"image/png":"17674f5b89443c45a15e4508288abeae5b1aec0f","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":77,"start":1660929859212,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929859564,"exec_count":199,"id":"9b43b7","input":"import sklearn\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.datasets import load_iris\nfrom sklearn.model_selection import GridSearchCV","kernel":"ds_env","pos":78,"start":1660929859559,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929859693,"exec_count":200,"id":"4dc31e","input":"clf = LogisticRegression(random_state=0).fit(X, y)\nparameters = {'penalty': ('l1', 'l2', 'elasticnet'), 'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga')}\nmy_LR_model = LogisticRegression()","kernel":"ds_env","pos":79,"start":1660929859685,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929860032,"exec_count":201,"id":"0eda4e","input":"clf = GridSearchCV(my_LR_model, parameters)","kernel":"ds_env","pos":80,"start":1660929860029,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929860990,"exec_count":202,"id":"e665a4","input":"clf.fit(X_train, y_train)","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n40 fits failed out of a total of 75.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 71, in _check_solver\n    raise ValueError(\nValueError: Only 'saga' solver supports elasticnet penalty, got solver=liblinear.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1101, in fit\n    raise ValueError(\nValueError: l1_ratio must be between 0 and 1; got (l1_ratio=None)\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan        nan 0.88974359        nan 0.88717949 0.88974359\n 0.88974359 0.88974359 0.88974359 0.88974359        nan        nan\n        nan        nan        nan]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-10 {color: black;background-color: white;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-10\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-24\" type=\"checkbox\" ><label for=\"sk-estimator-id-24\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-25\" type=\"checkbox\" ><label for=\"sk-estimator-id-25\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-26\" type=\"checkbox\" ><label for=\"sk-estimator-id-26\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LogisticRegression(),\n             param_grid={'penalty': ('l1', 'l2', 'elasticnet'),\n                         'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag',\n                                    'saga')})"},"exec_count":202}},"pos":81,"start":1660929860810,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929861185,"exec_count":203,"id":"a4ba7e","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'penalty': 'l1', 'solver': 'liblinear'}"},"exec_count":203}},"pos":82,"start":1660929861175,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929862970,"exec_count":205,"id":"9ff0be","input":"pred=clf.predict(X_test)","kernel":"ds_env","pos":84,"start":1660929862968,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929863826,"exec_count":206,"id":"45622a","input":"(pred==y_test).mean()\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9076923076923077"},"exec_count":206}},"pos":85,"start":1660929863808,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929864092,"exec_count":207,"id":"613520","input":"total_squared_error=(np.sum((y_test - pred)**2))\nmean_squared_error=total_squared_error/len(y_test)\nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.09230769230769231\n"}},"pos":86,"start":1660929864089,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929867203,"exec_count":209,"id":"37f2c2","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification\nfrom sklearn.model_selection import GridSearchCV\n","kernel":"ds_env","pos":88,"start":1660929867200,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929867861,"exec_count":210,"id":"9d02a3","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nparameters = {'penalty': ('l1', 'l2'),'loss':('hinge','squared_hinge'), 'multi_class':('ovr', 'crammer_singer')}\nmy_svm_model = LinearSVC()\n\n","kernel":"ds_env","pos":89,"start":1660929867856,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929872818,"exec_count":213,"id":"b9ee0a","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'loss': 'squared_hinge', 'multi_class': 'ovr', 'penalty': 'l2'}"},"exec_count":213}},"pos":92,"start":1660929872813,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929873388,"exec_count":214,"id":"1bfa99","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8897435897435898"},"exec_count":214}},"pos":93,"start":1660929873382,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929874016,"exec_count":215,"id":"126414","input":"pred=clf.predict(X_test)\n","kernel":"ds_env","pos":94,"start":1660929874002,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929874403,"exec_count":216,"id":"d6a9c1","input":"(pred==y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8923076923076924"},"exec_count":216}},"pos":95,"start":1660929874398,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929874624,"exec_count":217,"id":"e2fbc6","input":"total_squared_error=(np.sum((y_test - pred)**2))\nmean_squared_error=total_squared_error/len(y_test)\nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.1076923076923077\n"}},"pos":96,"start":1660929874620,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929875332,"exec_count":218,"id":"c67430","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, pred), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":218},"1":{"data":{"image/png":"78eb2903195a1fd19e0df1b545e293dd89509468","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":97,"start":1660929875132,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929875521,"exec_count":219,"id":"7a1203","input":"import numpy as np\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV\n","kernel":"ds_env","pos":98,"start":1660929875511,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929876428,"exec_count":220,"id":"9315c2","input":"clf = make_pipeline(StandardScaler(),SVC(gamma='auto')).fit(X,y)\nparameters = {'kernel': ('rbf', 'linear'),'decision_function_shape':('ovo', 'ovr')}\nmy_svm_model = SVC()","kernel":"ds_env","pos":99,"start":1660929876413,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929876438,"exec_count":221,"id":"7d14db","input":"clf = GridSearchCV(my_svm_model, parameters)","kernel":"ds_env","pos":100,"start":1660929876433,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929877373,"exec_count":222,"id":"40ce34","input":"clf.fit(X_train, y_train)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-12 {color: black;background-color: white;}#sk-container-id-12 pre{padding: 0;}#sk-container-id-12 div.sk-toggleable {background-color: white;}#sk-container-id-12 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-12 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-12 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-12 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-12 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-12 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-12 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-12 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-12 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-12 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-12 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-12 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-12 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-12 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-12 div.sk-item {position: relative;z-index: 1;}#sk-container-id-12 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-12 div.sk-item::before, #sk-container-id-12 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-12 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-12 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-12 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-12 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-12 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-12 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-12 div.sk-label-container {text-align: center;}#sk-container-id-12 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-12 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-12\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-30\" type=\"checkbox\" ><label for=\"sk-estimator-id-30\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-31\" type=\"checkbox\" ><label for=\"sk-estimator-id-31\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-32\" type=\"checkbox\" ><label for=\"sk-estimator-id-32\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=SVC(),\n             param_grid={'decision_function_shape': ('ovo', 'ovr'),\n                         'kernel': ('rbf', 'linear')})"},"exec_count":222}},"pos":101,"start":1660929877237,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929877492,"exec_count":223,"id":"fe971d","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'decision_function_shape': 'ovo', 'kernel': 'rbf'}"},"exec_count":223}},"pos":102,"start":1660929877475,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929877810,"exec_count":224,"id":"5f9350","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9384615384615383"},"exec_count":224}},"pos":103,"start":1660929877801,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929878567,"exec_count":225,"id":"298f0d","input":"pred=clf.predict(X_test)","kernel":"ds_env","pos":104,"start":1660929878507,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929878863,"exec_count":226,"id":"075b14","input":"(pred==y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9307692307692308"},"exec_count":226}},"pos":105,"start":1660929878852,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929879460,"exec_count":227,"id":"da3bbf","input":"total_squared_error=(np.sum((y_test - pred)**2))\nmean_squared_error=total_squared_error/len(y_test)\nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.06923076923076923\n"}},"pos":106,"start":1660929879447,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929880026,"exec_count":228,"id":"fc6a5b","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, pred), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":228},"1":{"data":{"image/png":"a1f8397ec43cf3f699065bbc22e8c415e728e7a6","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":107,"start":1660929879855,"state":"done","type":"cell"}
{"cell_type":"code","end":1660929910017,"exec_count":231,"id":"fb367e","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Gender', names='class', color='class', title= 'Gender correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()\n","kernel":"ds_env","output":{"0":{"data":{"iframe":"c578ae012d7b780d5db30d22646ac0b2a51d242a"}}},"pos":108,"start":1660929909949,"state":"done","type":"cell"}
{"cell_type":"code","end":1660930003079,"exec_count":232,"id":"472ffd","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Polyuria', names='class', color='class', title= 'Polyuria correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"64cb2a6449aae5a3094cd2b7b4543c8416c32d70"}}},"pos":109,"start":1660930003017,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":204,"id":"90dcb2","input":"clf.best_score_\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8897435897435898"},"exec_count":204}},"pos":83,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":208,"id":"9ea116","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\n\n\n\n\n\nsns.heatmap(confusion_matrix(y_test, pred), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":208},"1":{"data":{"image/png":"d787cacee1e78ad995fea6ccb44db9744d872945","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":87,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":211,"id":"42f6ef","input":"clf = GridSearchCV(my_svm_model, parameters)\n\n\n\n","kernel":"ds_env","pos":90,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":212,"id":"409abe","input":"clf.fit(X_train, y_train)\n\n\n","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n10 fits failed out of a total of 40.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='hinge' is not supported, Parameters: penalty='l1', loss='hinge', dual=True\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='squared_hinge' are not supported when dual=True, Parameters: penalty='l1', loss='squared_hinge', dual=True\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan 0.88205128 0.88205128 0.88205128        nan 0.88974359\n 0.88205128 0.88205128]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-11 {color: black;background-color: white;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-11\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-27\" type=\"checkbox\" ><label for=\"sk-estimator-id-27\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-28\" type=\"checkbox\" ><label for=\"sk-estimator-id-28\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-29\" type=\"checkbox\" ><label for=\"sk-estimator-id-29\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LinearSVC(),\n             param_grid={'loss': ('hinge', 'squared_hinge'),\n                         'multi_class': ('ovr', 'crammer_singer'),\n                         'penalty': ('l1', 'l2')})"},"exec_count":212}},"pos":91,"state":"done","type":"cell"}
{"cell_type":"code","id":"1395e9","input":"","pos":40,"type":"cell"}
{"end":1660930027073,"exec_count":233,"id":"6af476","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Polydipsia', names='class', color='class', title= 'Polydipsia correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"ce957e478aeeb0a875905835a0ff6613dab85195"}}},"pos":110,"start":1660930026997,"state":"done","type":"cell"}
{"id":"15267c","input":"","pos":116,"type":"cell"}
{"id":"2cc228","input":"","pos":117,"type":"cell"}
{"id":"3986d9","input":"","pos":111,"type":"cell"}
{"id":"414379","input":"","pos":115,"type":"cell"}
{"id":"46029c","input":"","pos":118,"type":"cell"}
{"id":"538f1f","input":"","pos":114,"type":"cell"}
{"id":"77a239","input":"","pos":120,"type":"cell"}
{"id":"8ae564","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Polydipsya', names='class', color='class', title= 'Gender correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","pos":108.5,"type":"cell"}
{"id":"dd9584","input":"","pos":113,"type":"cell"}
{"id":"ec25a9","input":"","pos":119,"type":"cell"}
{"id":"ef43d0","input":"","pos":112,"type":"cell"}
{"id":"f34a04","input":"","pos":121,"type":"cell"}
{"id":0,"time":1660768197389,"type":"user"}
{"last_load":1660928333312,"type":"file"}