{"backend_state":"running","connection_file":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/.local/share/jupyter/runtime/kernel-e2d71d86-9bd1-43e9-8556-937a9b8f7722.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1660927206743,"exec_count":15,"id":"706a0b","input":"import pandas as pd\nimport numpy as np\nimport plotly.express as px","kernel":"ds_env","pos":0,"start":1660927206727,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927217848,"exec_count":21,"id":"95eb17","input":"df = pd.read_csv('diabetes_data_upload.csv')","kernel":"ds_env","pos":13,"start":1660927217830,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927218386,"exec_count":22,"id":"34fddf","input":"df.head()","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n      <th>class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>58</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>41</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>45</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>60</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   Age Gender Polyuria Polydipsia sudden weight loss weakness Polyphagia  \\\n0   40   Male       No        Yes                 No      Yes         No   \n1   58   Male       No         No                 No      Yes         No   \n2   41   Male      Yes         No                 No      Yes        Yes   \n3   45   Male       No         No                Yes      Yes        Yes   \n4   60   Male      Yes        Yes                Yes      Yes        Yes   \n\n  Genital thrush visual blurring Itching Irritability delayed healing  \\\n0             No              No     Yes           No             Yes   \n1             No             Yes      No           No              No   \n2             No              No     Yes           No             Yes   \n3            Yes              No     Yes           No             Yes   \n4             No             Yes     Yes          Yes             Yes   \n\n  partial paresis muscle stiffness Alopecia Obesity     class  \n0              No              Yes      Yes     Yes  Positive  \n1             Yes               No      Yes      No  Positive  \n2              No              Yes      Yes      No  Positive  \n3              No               No       No      No  Positive  \n4             Yes              Yes      Yes     Yes  Positive  "},"exec_count":22}},"pos":14,"scrolled":true,"start":1660927218366,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927221112,"exec_count":23,"id":"55296e","input":"Visual Blurring \n\n\nWhat is Visual Blurring -  A visual symptom that makes it difficult to see clearly or sharply\n\n\nHow does this symptom relate to diabetes -  If your blood sugar levels change quickly from low to normal, the shape of your eye's lens' can be affected, and your vision can be blurred.\n\n\nWhat is the effect - Blurry or wavy vision in the center of your field of vision","kernel":"ds_env","output":{"0":{"ename":"SyntaxError","evalue":"invalid syntax (3535386915.py, line 1)","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [23]\u001b[0;36m\u001b[0m\n\u001b[0;31m    Visual Blurring\u001b[0m\n\u001b[0m           ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}},"pos":19,"start":1660927221087,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927221623,"exec_count":24,"id":"db3b19","input":"df['Age'].isnull().values.any()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"False"},"exec_count":24}},"pos":20,"start":1660927221609,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927222332,"exec_count":25,"id":"e67a7b","input":"results = []\nfor col in df.columns:\n    missing_or_not = df[col].isnull().values.any()\n    print(col + ' ' + str(missing_or_not))","kernel":"ds_env","output":{"0":{"name":"stdout","text":"Age False\nGender False\nPolyuria False\nPolydipsia False\nsudden weight loss False\nweakness False\nPolyphagia False\nGenital thrush False\nvisual blurring False\nItching False\nIrritability False\ndelayed healing False\npartial paresis False\nmuscle stiffness False\nAlopecia False\nObesity False\nclass False\n"}},"pos":21,"start":1660927222309,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927222720,"exec_count":26,"id":"77f8cb","input":"def Change_to_Value (Input):\n    if Input == 'Yes':\n        return 1\n    else:\n        return 0","kernel":"ds_env","pos":22,"start":1660927222709,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927223021,"exec_count":27,"id":"91a3e2","input":"Change_to_Value('No')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0"},"exec_count":27}},"pos":23,"start":1660927222998,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927223887,"exec_count":28,"id":"57e860","input":"def convert(x):\n    if x == 'Yes' or x == 'Male' or x == 'Positive':\n        return 1\n    else:\n        return 0\n","kernel":"ds_env","pos":25,"start":1660927223884,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927224533,"exec_count":29,"id":"da3e0f","input":"convert('Male')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"1"},"exec_count":29}},"pos":26,"start":1660927224516,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927225218,"exec_count":30,"id":"5a5cdb","input":"df['Gender'].apply(convert)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0      1\n1      1\n2      1\n3      1\n4      1\n      ..\n515    0\n516    0\n517    0\n518    0\n519    1\nName: Gender, Length: 520, dtype: int64"},"exec_count":30}},"pos":27,"start":1660927225203,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927225234,"exec_count":31,"id":"66d53c","input":"df['Gender']","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0        Male\n1        Male\n2        Male\n3        Male\n4        Male\n        ...  \n515    Female\n516    Female\n517    Female\n518    Female\n519      Male\nName: Gender, Length: 520, dtype: object"},"exec_count":31}},"pos":28,"start":1660927225230,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927225584,"exec_count":32,"id":"daa5f9","input":"for col in df.columns:\n    if col != 'Age':\n        df[col] = df[col].apply(convert)","kernel":"ds_env","pos":29,"start":1660927225567,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927226853,"exec_count":33,"id":"5c2ae7","input":"X = df.drop(['class'], axis = 1)\nY = df['class']","kernel":"ds_env","pos":32,"start":1660927226843,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927228214,"exec_count":34,"id":"199507","input":"X = df.drop(['class'], axis = 1)\nY = df['class']","kernel":"ds_env","pos":35,"start":1660927228206,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927228260,"exec_count":35,"id":"df7b22","input":"X.corrwith(Y)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\ndtype: float64"},"exec_count":35}},"pos":36,"start":1660927228220,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927228390,"exec_count":36,"id":"e90e57","input":"corr = df.corr()","kernel":"ds_env","pos":37,"start":1660927228382,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927228910,"exec_count":37,"id":"668449","input":"corr = df.corr()\ncorr['class']","kernel":"ds_env","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\nclass                 1.000000\nName: class, dtype: float64"},"exec_count":37}},"pos":38,"start":1660927228892,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927230200,"exec_count":39,"id":"d413b2","input":"corr_data = X.corrwith(Y).to_frame().reset_index()\nfig = px.bar(corr_data, x='index', y=0, title=\"Correlation between Features and Having Diabetes\")\nfig.show()\n","kernel":"ds_env","output":{"0":{"data":{"iframe":"c799baa1c3a06e9df8699cd8dfa892eef1a9b616"}}},"pos":41,"start":1660927230116,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927290151,"exec_count":116,"id":"8e3a75","input":"fig = px.bar(df, x ='sudden weight loss', color ='Gender')\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"11e8f9cc7966808c63d009d882e0e5f9794fc7dd"}}},"pos":1,"scrolled":true,"start":1660927290040,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927302095,"exec_count":119,"id":"f05cdd","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Polyphagia', names='class', color= 'class', title= 'Polyphagia correlation with Diabetes', hole= .5,\n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"4670a5ac4386894188ac7f957f0f81fcc7bb8282"}}},"pos":8,"start":1660927302022,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927315997,"exec_count":121,"id":"0f7e8c","input":"X = df.drop(['class', 'Age', 'weakness', 'Genital thrush', 'Itching', 'delayed healing', 'muscle stiffness', 'Obesity'], axis = 1)\ny = df['class']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state = 42)\n\n\n\n","kernel":"ds_env","pos":42,"start":1660927315991,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927317482,"exec_count":122,"id":"be5467","input":"from sklearn.preprocessing import StandardScaler\nss = StandardScaler()\nX_train = ss.fit_transform(X_train)\nX_test = ss.transform(X_test)\n\n","kernel":"ds_env","pos":43,"start":1660927317467,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927319306,"exec_count":123,"id":"899aa5","input":"# Logistic Regression","kernel":"ds_env","pos":45,"start":1660927319303,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927320051,"exec_count":124,"id":"b5b0f2","input":"from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\n","kernel":"ds_env","pos":46,"start":1660927320035,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927321247,"exec_count":125,"id":"668510","input":"clf = LogisticRegression(random_state=0).fit(X, y)","kernel":"ds_env","pos":48,"start":1660927321231,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927321755,"exec_count":126,"id":"85b127","input":"y_hat = clf.predict(x_test)\ny_hat","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1,\n       0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1,\n       1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1,\n       1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1,\n       1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,\n       1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1])"},"exec_count":126}},"pos":49,"start":1660927321746,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927322284,"exec_count":127,"id":"4d1688","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.49230769230769234\n"}},"pos":50,"start":1660927322260,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927323442,"exec_count":129,"id":"526811","input":"#precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.36956522, 0.58333333])"},"exec_count":129}},"pos":52,"start":1660927323436,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927324198,"exec_count":130,"id":"70f56b","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"66"},"exec_count":130}},"pos":53,"start":1660927324184,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927324955,"exec_count":131,"id":"d9a665","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.32692308, 0.62820513])"},"exec_count":131}},"pos":54,"start":1660927324942,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927326370,"exec_count":132,"id":"625ddf","input":"# svm linear","kernel":"ds_env","pos":56,"start":1660927326348,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927327036,"exec_count":133,"id":"1434fa","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification","kernel":"ds_env","pos":57,"start":1660927327015,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927327584,"exec_count":134,"id":"f656c1","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nclf.fit(X, y)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-6\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-16\" type=\"checkbox\" ><label for=\"sk-estimator-id-16\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-17\" type=\"checkbox\" ><label for=\"sk-estimator-id-17\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">StandardScaler</label><div class=\"sk-toggleable__content\"><pre>StandardScaler()</pre></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-18\" type=\"checkbox\" ><label for=\"sk-estimator-id-18\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC(random_state=0, tol=1e-05)</pre></div></div></div></div></div></div></div>","text/plain":"Pipeline(steps=[('standardscaler', StandardScaler()),\n                ('linearsvc', LinearSVC(random_state=0, tol=1e-05))])"},"exec_count":134}},"pos":58,"start":1660927327565,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927328280,"exec_count":135,"id":"260e1f","input":"y_hat = clf.predict(x_test)\ny_hat","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1,\n       0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1,\n       1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1,\n       1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1,\n       1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,\n       1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1])"},"exec_count":135}},"pos":59,"start":1660927328265,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927329495,"exec_count":136,"id":"e727d7","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.5\n"}},"pos":61,"start":1660927329490,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927330743,"exec_count":138,"id":"694191","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.32608696, 0.5952381 ])"},"exec_count":138}},"pos":63,"start":1660927330728,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927331440,"exec_count":139,"id":"90e984","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"65"},"exec_count":139}},"pos":64,"start":1660927331436,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927332065,"exec_count":140,"id":"9449b5","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.30612245, 0.61728395])"},"exec_count":140}},"pos":65,"start":1660927332045,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927333217,"exec_count":141,"id":"1ba837","input":"#KNN","kernel":"ds_env","pos":67,"start":1660927333213,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927333806,"exec_count":142,"id":"fd46d6","input":"import sklearn #our favorite machine learning library\nfrom sklearn.neighbors import KNeighborsClassifier as KNN #this will import our model as KNN","kernel":"ds_env","pos":68,"start":1660927333793,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927334385,"exec_count":143,"id":"0eab4e","input":"# Creating the KNN model object -- we need to tell it the number of neighbors to look at.\nk = 7 #number of neighbors to look at (look at 7 nearest neighbors)\nmy_KNN_model = KNN(n_neighbors=k)","kernel":"ds_env","pos":69,"start":1660927334381,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927334877,"exec_count":144,"id":"a116e9","input":"my_KNN_model.fit(x_train, y_train) #train the model on our past results x_train (inputs) and y_train (outputs)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-7\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier(n_neighbors=7)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-19\" type=\"checkbox\" checked><label for=\"sk-estimator-id-19\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier(n_neighbors=7)</pre></div></div></div></div></div>","text/plain":"KNeighborsClassifier(n_neighbors=7)"},"exec_count":144}},"pos":70,"start":1660927334860,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927335500,"exec_count":145,"id":"ad15a6","input":"y_hat = my_KNN_model.predict(x_test)","kernel":"ds_env","pos":71,"start":1660927335487,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927335986,"exec_count":146,"id":"15e4c1","input":"y_hat","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0,\n       0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1,\n       1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0,\n       0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1,\n       0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,\n       1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1])"},"exec_count":146}},"pos":72,"start":1660927335946,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927336532,"exec_count":147,"id":"b5c596","input":"np.array(y_test)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1,\n       1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,\n       0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":147}},"pos":73,"start":1660927336519,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927337129,"exec_count":148,"id":"a03838","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.4307692307692308\n"}},"pos":74,"start":1660927337116,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927338504,"exec_count":150,"id":"075f7d","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.45652174, 0.63095238])"},"exec_count":150}},"pos":76,"start":1660927338483,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927339096,"exec_count":151,"id":"54c259","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"74"},"exec_count":151}},"pos":77,"start":1660927339080,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927339706,"exec_count":152,"id":"67961a","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.40384615, 0.67948718])"},"exec_count":152}},"pos":78,"start":1660927339701,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927341062,"exec_count":153,"id":"5d5b35","input":"from sklearn.svm import SVC\nfrom sklearn.model_selection import StratifiedShuffleSplit\nfrom sklearn.model_selection import GridSearchCV","kernel":"ds_env","pos":80,"start":1660927341039,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927342121,"exec_count":154,"id":"0a62e2","input":"#RBF","kernel":"ds_env","pos":82,"start":1660927342112,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927342909,"exec_count":155,"id":"563984","input":"import matplotlib.pyplot as plt\n\nplt.figure(figsize=(8, 6))\nfrom sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":155},"1":{"data":{"image/png":"5672e81939e0869b7df679ab5790c910a0c34917","text/plain":"<Figure size 576x432 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":83,"start":1660927342741,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927343435,"exec_count":156,"id":"56f823","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.45652174, 0.63095238])"},"exec_count":156}},"pos":84,"start":1660927343419,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927343982,"exec_count":157,"id":"ad7e92","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"74"},"exec_count":157}},"pos":85,"start":1660927343968,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927344540,"exec_count":158,"id":"729a4a","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","kernel":"ds_env","output":{"0":{"data":{"text/plain":"array([0.40384615, 0.67948718])"},"exec_count":158}},"pos":86,"start":1660927344532,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927347184,"exec_count":159,"id":"682080","input":"#Logistic regression\n#svmrbf and svm linear\n#knn\n#naive bayes\n#Decision trees\n#Random forest\n\nprecision, accuracy, recall","kernel":"ds_env","output":{"0":{"ename":"NameError","evalue":"name 'precision' is not defined","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","Input \u001b[0;32mIn [159]\u001b[0m, in \u001b[0;36m<cell line: 8>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m#Logistic regression\u001b[39;00m\n\u001b[1;32m      2\u001b[0m \u001b[38;5;66;03m#svmrbf and svm linear\u001b[39;00m\n\u001b[1;32m      3\u001b[0m \u001b[38;5;66;03m#knn\u001b[39;00m\n\u001b[1;32m      4\u001b[0m \u001b[38;5;66;03m#naive bayes\u001b[39;00m\n\u001b[1;32m      5\u001b[0m \u001b[38;5;66;03m#Decision trees\u001b[39;00m\n\u001b[1;32m      6\u001b[0m \u001b[38;5;66;03m#Random forest\u001b[39;00m\n\u001b[0;32m----> 8\u001b[0m \u001b[43mprecision\u001b[49m, accuracy, recall\n","\u001b[0;31mNameError\u001b[0m: name 'precision' is not defined"]}},"pos":90,"start":1660927347177,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927358140,"exec_count":160,"id":"50e1e3","input":"import sklearn\nfrom sklearn.model_selection import train_test_split\n\nx_train, x_test ,y_train, y_test = train_test_split(X, Y)\n","kernel":"ds_env","pos":94,"start":1660927358126,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927358555,"exec_count":161,"id":"d8c2cb","input":"print(x_train.shape)\nprint(x_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"(390, 9)\n(130, 9)\n(390,)\n(130,)\n"}},"pos":95,"start":1660927358533,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927359074,"exec_count":162,"id":"d222c3","input":"x_test.head()","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>Polyphagia</th>\n      <th>visual blurring</th>\n      <th>Irritability</th>\n      <th>partial paresis</th>\n      <th>Alopecia</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>172</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>457</th>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>120</th>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>377</th>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"     Gender  Polyuria  Polydipsia  sudden weight loss  Polyphagia  \\\n172       1         1           0                   0           0   \n457       0         1           1                   1           1   \n120       1         1           1                   0           1   \n377       1         0           0                   1           0   \n40        0         0           1                   1           1   \n\n     visual blurring  Irritability  partial paresis  Alopecia  \n172                1             0                1         1  \n457                1             1                1         0  \n120                0             0                0         1  \n377                0             0                0         0  \n40                 1             1                0         0  "},"exec_count":162}},"pos":96,"start":1660927359061,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927360590,"exec_count":163,"id":"a46f63","input":" y_train.head()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"280    0\n32     1\n123    1\n196    1\n326    0\nName: class, dtype: int64"},"exec_count":163}},"pos":99,"start":1660927360578,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927361105,"exec_count":164,"id":"3561f8","input":"y_test.head","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<bound method NDFrame.head of 172    1\n457    1\n120    1\n377    0\n40     1\n      ..\n327    0\n429    1\n74     1\n200    0\n231    0\nName: class, Length: 130, dtype: int64>"},"exec_count":164}},"pos":100,"start":1660927361094,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927362451,"exec_count":165,"id":"05281a","input":"#KNN","kernel":"ds_env","pos":104,"start":1660927362441,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927362994,"exec_count":166,"id":"9da828","input":"import sklearn #our favorite machine learning library\nfrom sklearn.neighbors import KNeighborsClassifier as KNN #this will import our model as KNN\nfrom sklearn.model_selection import GridSearchCV","kernel":"ds_env","pos":105,"start":1660927362983,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927363344,"exec_count":167,"id":"6ae3bf","input":"# Creating the KNN model object -- we need to tell it the number of neighbors to look at.\nk = 7 #number of neighbors to look at (look at 7 nearest neighbors)\nparameters = {'n_neighbors':[3, 5, 7], 'weights': ('uniform', 'distance'), 'algorithm': ('auto', 'ball_tree')}\nmy_KNN_model = KNN()","kernel":"ds_env","pos":106,"start":1660927363330,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927363779,"exec_count":168,"id":"5c7940","input":"clf = GridSearchCV(my_KNN_model, parameters)","kernel":"ds_env","pos":107,"start":1660927363769,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927364741,"exec_count":169,"id":"6b3712","input":"clf.fit(x_train, y_train)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-8 {color: black;background-color: white;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-8\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-20\" type=\"checkbox\" ><label for=\"sk-estimator-id-20\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-21\" type=\"checkbox\" ><label for=\"sk-estimator-id-21\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-22\" type=\"checkbox\" ><label for=\"sk-estimator-id-22\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={'algorithm': ('auto', 'ball_tree'),\n                         'n_neighbors': [3, 5, 7],\n                         'weights': ('uniform', 'distance')})"},"exec_count":169}},"pos":108,"start":1660927364309,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927364823,"exec_count":170,"id":"a96c03","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'algorithm': 'ball_tree', 'n_neighbors': 3, 'weights': 'distance'}"},"exec_count":170}},"pos":109,"start":1660927364810,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927365331,"exec_count":171,"id":"76c2dc","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9461538461538461"},"exec_count":171}},"pos":110,"start":1660927365317,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927365894,"exec_count":172,"id":"6f471c","input":"pred = clf.predict(x_test)","kernel":"ds_env","pos":111,"start":1660927365883,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927366590,"exec_count":173,"id":"56b222","input":"(pred == y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9307692307692308"},"exec_count":173}},"pos":112,"start":1660927366564,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927366900,"exec_count":174,"id":"2775f9","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.49230769230769234\n"}},"pos":113,"start":1660927366885,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927367514,"exec_count":175,"id":"d28d0f","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":175},"1":{"data":{"image/png":"6ae91a6a6bab2b3c88a831aa625f1a8147e88443","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":114,"start":1660927367345,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927368973,"exec_count":176,"id":"def998","input":"#SVM linear","kernel":"ds_env","pos":117,"start":1660927368968,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927369514,"exec_count":177,"id":"d9bc80","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification\nfrom sklearn.model_selection import GridSearchCV","kernel":"ds_env","pos":118,"start":1660927369502,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927370514,"exec_count":178,"id":"abfa55","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nparameters = {'penalty': ('l1', 'l2'),'loss':('hinge','squared_hinge'), 'multi_class':('ovr', 'crammer_singer')}\nmy_svm_model = LinearSVC()\n","kernel":"ds_env","pos":120,"start":1660927370509,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927370972,"exec_count":179,"id":"7a386e","input":"clf = GridSearchCV(my_svm_model, parameters)","kernel":"ds_env","pos":121,"start":1660927370963,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927371667,"exec_count":180,"id":"6d733b","input":"clf.fit(x_train, y_train)","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n10 fits failed out of a total of 40.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='hinge' is not supported, Parameters: penalty='l1', loss='hinge', dual=True\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='squared_hinge' are not supported when dual=True, Parameters: penalty='l1', loss='squared_hinge', dual=True\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan 0.91282051 0.91538462 0.91538462        nan 0.91282051\n 0.91538462 0.91538462]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-9 {color: black;background-color: white;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-9\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-23\" type=\"checkbox\" ><label for=\"sk-estimator-id-23\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-24\" type=\"checkbox\" ><label for=\"sk-estimator-id-24\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-25\" type=\"checkbox\" ><label for=\"sk-estimator-id-25\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LinearSVC(),\n             param_grid={'loss': ('hinge', 'squared_hinge'),\n                         'multi_class': ('ovr', 'crammer_singer'),\n                         'penalty': ('l1', 'l2')})"},"exec_count":180}},"pos":122,"start":1660927371460,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927372048,"exec_count":181,"id":"306f0d","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'loss': 'hinge', 'multi_class': 'crammer_singer', 'penalty': 'l1'}"},"exec_count":181}},"pos":123,"start":1660927372041,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927372596,"exec_count":182,"id":"2be201","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9153846153846154"},"exec_count":182}},"pos":124,"start":1660927372585,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927373141,"exec_count":183,"id":"c90615","input":"pred = clf.predict(x_test)","kernel":"ds_env","pos":125,"start":1660927373122,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927373590,"exec_count":184,"id":"651505","input":"(pred == y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8461538461538461"},"exec_count":184}},"pos":126,"start":1660927373575,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927374137,"exec_count":185,"id":"ab39af","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.49230769230769234\n"}},"pos":127,"start":1660927374121,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927374724,"exec_count":186,"id":"fbaca7","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":186},"1":{"data":{"image/png":"6ae91a6a6bab2b3c88a831aa625f1a8147e88443","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":128,"start":1660927374527,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927375527,"exec_count":187,"id":"9e4995","input":"# Logistic Regression","kernel":"ds_env","pos":130,"start":1660927375520,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927376004,"exec_count":188,"id":"bc72f0","input":"from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV\n","kernel":"ds_env","pos":131,"start":1660927375992,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927376471,"exec_count":189,"id":"9e6a10","input":"clf = LogisticRegression(random_state=0).fit(X, y)\nparameters = {'penalty': ('l1', 'l2', 'elasticnet'), 'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga')}\nmy_LR_model = LogisticRegression()","kernel":"ds_env","pos":132,"start":1660927376455,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927376945,"exec_count":190,"id":"62f91a","input":"clf = GridSearchCV(my_LR_model, parameters)","kernel":"ds_env","pos":133,"start":1660927376942,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927377808,"exec_count":191,"id":"334c66","input":"clf.fit(x_train, y_train)","kernel":"ds_env","output":{"0":{"name":"stderr","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n40 fits failed out of a total of 75.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 71, in _check_solver\n    raise ValueError(\nValueError: Only 'saga' solver supports elasticnet penalty, got solver=liblinear.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1101, in fit\n    raise ValueError(\nValueError: l1_ratio must be between 0 and 1; got (l1_ratio=None)\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan        nan 0.92051282        nan 0.92307692 0.91538462\n 0.91538462 0.91538462 0.91538462 0.91538462        nan        nan\n        nan        nan        nan]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-10 {color: black;background-color: white;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-10\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-26\" type=\"checkbox\" ><label for=\"sk-estimator-id-26\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-27\" type=\"checkbox\" ><label for=\"sk-estimator-id-27\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-28\" type=\"checkbox\" ><label for=\"sk-estimator-id-28\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LogisticRegression(),\n             param_grid={'penalty': ('l1', 'l2', 'elasticnet'),\n                         'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag',\n                                    'saga')})"},"exec_count":191}},"pos":134,"start":1660927377461,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927377915,"exec_count":192,"id":"9f5810","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'penalty': 'l1', 'solver': 'saga'}"},"exec_count":192}},"pos":135,"start":1660927377907,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927378633,"exec_count":193,"id":"bc801f","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9230769230769231"},"exec_count":193}},"pos":136,"start":1660927378626,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927379188,"exec_count":194,"id":"e396c2","input":"pred = clf.predict(x_test)","kernel":"ds_env","pos":137,"start":1660927379185,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927380071,"exec_count":195,"id":"c2b707","input":"(pred == y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.8615384615384616"},"exec_count":195}},"pos":138,"start":1660927380066,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927380083,"exec_count":196,"id":"d80b96","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.49230769230769234\n"}},"pos":139,"start":1660927380075,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927380602,"exec_count":197,"id":"7853ac","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":197},"1":{"data":{"image/png":"6ae91a6a6bab2b3c88a831aa625f1a8147e88443","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":140,"start":1660927380434,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927381411,"exec_count":198,"id":"4aa2ad","input":"# RBF","kernel":"ds_env","pos":142,"start":1660927381405,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927381813,"exec_count":199,"id":"420f58","input":"import numpy as np\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV\n","kernel":"ds_env","pos":143,"start":1660927381803,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927382316,"exec_count":200,"id":"73bb9e","input":"clf = make_pipeline(StandardScaler(),SVC(gamma='auto')).fit(X,y)\nparameters = {'kernel': ('rbf', 'linear'),'decision_function_shape':('ovo', 'ovr')}\nmy_svc_model = SVC()","kernel":"ds_env","pos":144,"start":1660927382305,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927382781,"exec_count":201,"id":"934838","input":"clf = GridSearchCV(my_svc_model, parameters)","kernel":"ds_env","pos":145,"start":1660927382771,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927383357,"exec_count":202,"id":"6567bb","input":"clf.fit(x_train, y_train)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<style>#sk-container-id-11 {color: black;background-color: white;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-11\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-29\" type=\"checkbox\" ><label for=\"sk-estimator-id-29\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-30\" type=\"checkbox\" ><label for=\"sk-estimator-id-30\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-31\" type=\"checkbox\" ><label for=\"sk-estimator-id-31\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=SVC(),\n             param_grid={'decision_function_shape': ('ovo', 'ovr'),\n                         'kernel': ('rbf', 'linear')})"},"exec_count":202}},"pos":146,"start":1660927383210,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927383789,"exec_count":203,"id":"76063e","input":"clf.best_params_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"{'decision_function_shape': 'ovo', 'kernel': 'rbf'}"},"exec_count":203}},"pos":147,"start":1660927383785,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927384137,"exec_count":204,"id":"b73e43","input":"clf.best_score_","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9384615384615385"},"exec_count":204}},"pos":148,"start":1660927384126,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927384681,"exec_count":205,"id":"b6216b","input":"pred = clf.predict(x_test)","kernel":"ds_env","pos":149,"start":1660927384673,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927385143,"exec_count":206,"id":"2c0cc1","input":"(pred == y_test).mean()","kernel":"ds_env","output":{"0":{"data":{"text/plain":"0.9230769230769231"},"exec_count":206}},"pos":150,"start":1660927385132,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927385480,"exec_count":207,"id":"ff0404","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.49230769230769234\n"}},"pos":151,"start":1660927385467,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927386132,"exec_count":208,"id":"d0721c","input":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":208},"1":{"data":{"image/png":"6ae91a6a6bab2b3c88a831aa625f1a8147e88443","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":152,"start":1660927385927,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927428247,"exec_count":209,"id":"3781ed","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":209},"1":{"data":{"image/png":"f8dba3806b80b01704e18bf363e230404d447a3b","text/plain":"<Figure size 576x432 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":75,"start":1660927428048,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927448028,"exec_count":210,"id":"28ed9e","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":210},"1":{"data":{"image/png":"f8dba3806b80b01704e18bf363e230404d447a3b","text/plain":"<Figure size 576x432 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":62,"start":1660927447776,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927455932,"exec_count":211,"id":"277cc0","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","kernel":"ds_env","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":211},"1":{"data":{"image/png":"f8dba3806b80b01704e18bf363e230404d447a3b","text/plain":"<Figure size 576x432 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":51,"scrolled":true,"start":1660927455502,"state":"done","type":"cell"}
{"cell_type":"code","end":1660927494541,"exec_count":213,"id":"52cad1","input":"import plotly.express as px\nDF = df\nfig = px.pie(DF, values='visual blurring', names='class',color= 'class', title= 'Visual Blurring correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"da61ee2d03264321991fa0290a714667ad0df23b"}}},"pos":9,"start":1660927494358,"state":"done","type":"cell"}
{"cell_type":"code","end":1660930462306,"exec_count":226,"id":"390b5c","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Alopecia', names='class', color='class', title= 'Sudden Weight Loss correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"4f609ebb214b8928aaf128e30744e1676f70ff78"}}},"pos":7,"start":1660930462194,"state":"done","type":"cell"}
{"cell_type":"code","end":1660934738167,"exec_count":228,"id":"77e84e","input":"corr = df.corr()\nfig = px.imshow(corr, aspect=\"auto\", color_continuous_scale='algae', text_auto = True)\nfig.show()\n\n\n","kernel":"ds_env","output":{"0":{"data":{"iframe":"91bcf7bd27ec5933c36137169ec27a8d1ea5a06a"}}},"pos":39,"start":1660934738115,"state":"done","type":"cell"}
{"cell_type":"code","end":1660934823416,"exec_count":230,"id":"1f9786","input":"fig = px.histogram(df, x ='visual blurring', color ='Gender',\n                  color_discrete_sequence=['lightcyan'])\nfig.show()","kernel":"ds_env","output":{"0":{"data":{"iframe":"919d54c7c4e9d7626d30a4a870162245d3514fc2"}}},"pos":3,"scrolled":true,"start":1660934823325,"state":"done","type":"cell"}
{"cell_type":"code","id":"040e5a","input":"","pos":18,"type":"cell"}
{"cell_type":"code","id":"0b933c","input":"","pos":173,"type":"cell"}
{"cell_type":"code","id":"159137","input":"","pos":93,"type":"cell"}
{"cell_type":"code","id":"16b339","input":"","pos":40,"type":"cell"}
{"cell_type":"code","id":"18bc60","input":"","pos":154,"type":"cell"}
{"cell_type":"code","id":"1c1bfa","input":"","pos":47,"type":"cell"}
{"cell_type":"code","id":"2f35c2","input":"","pos":97,"type":"cell"}
{"cell_type":"code","id":"335c51","input":"","pos":92,"type":"cell"}
{"cell_type":"code","id":"36bb58","input":"","pos":171,"type":"cell"}
{"cell_type":"code","id":"3a2654","input":"","pos":88,"type":"cell"}
{"cell_type":"code","id":"3e0c47","input":"","pos":11,"type":"cell"}
{"cell_type":"code","id":"53f52e","input":"","pos":101,"type":"cell"}
{"cell_type":"code","id":"557b3b","input":"","pos":175,"type":"cell"}
{"cell_type":"code","id":"5d1418","input":"","pos":116,"type":"cell"}
{"cell_type":"code","id":"6027ee","input":"","pos":177,"type":"cell"}
{"cell_type":"code","id":"60c240","input":"","pos":155,"type":"cell"}
{"cell_type":"code","id":"65c6fc","input":"","pos":160,"type":"cell"}
{"cell_type":"code","id":"70815d","input":"","pos":4,"type":"cell"}
{"cell_type":"code","id":"750be2","input":"","pos":169,"type":"cell"}
{"cell_type":"code","id":"799ef8","input":"","pos":98,"type":"cell"}
{"cell_type":"code","id":"7af958","input":"","pos":55,"type":"cell"}
{"cell_type":"code","id":"806c7d","input":"","pos":172,"type":"cell"}
{"cell_type":"code","id":"80a583","input":"","pos":141,"type":"cell"}
{"cell_type":"code","id":"8711fc","input":"","pos":60,"type":"cell"}
{"cell_type":"code","id":"8daad8","input":"","pos":157,"type":"cell"}
{"cell_type":"code","id":"9045f9","input":"","pos":30,"type":"cell"}
{"cell_type":"code","id":"935370","input":"","pos":24,"type":"cell"}
{"cell_type":"code","id":"93fdd4","input":"","pos":162,"type":"cell"}
{"cell_type":"code","id":"987a8e","input":"","pos":166,"type":"cell"}
{"cell_type":"code","id":"99e966","input":"","pos":79,"type":"cell"}
{"cell_type":"code","id":"9c8ffb","input":"","pos":119,"type":"cell"}
{"cell_type":"code","id":"a17197","input":"\n","pos":89,"type":"cell"}
{"cell_type":"code","id":"a17f94","input":"","pos":168,"type":"cell"}
{"cell_type":"code","id":"a1dcf4","input":"","pos":6,"type":"cell"}
{"cell_type":"code","id":"a2c269","input":"","pos":91,"type":"cell"}
{"cell_type":"code","id":"a31134","input":"","pos":159,"type":"cell"}
{"cell_type":"code","id":"a8de87","input":"","pos":12,"type":"cell"}
{"cell_type":"code","id":"ae649e","input":"","pos":115,"type":"cell"}
{"cell_type":"code","id":"af2221","input":"","pos":158,"type":"cell"}
{"cell_type":"code","id":"b24ae0","input":"","pos":44,"type":"cell"}
{"cell_type":"code","id":"b2b40e","input":"","pos":156,"type":"cell"}
{"cell_type":"code","id":"b72b66","input":"","pos":161,"type":"cell"}
{"cell_type":"code","id":"b9ab30","input":"","pos":174,"type":"cell"}
{"cell_type":"code","id":"ba5dfb","input":"","pos":102,"type":"cell"}
{"cell_type":"code","id":"bbdc9e","input":"","pos":129,"type":"cell"}
{"cell_type":"code","id":"bbfb0e","input":"","pos":163,"type":"cell"}
{"cell_type":"code","id":"bcfac7","input":"","pos":170,"type":"cell"}
{"cell_type":"code","id":"c2422f","input":"","pos":5,"type":"cell"}
{"cell_type":"code","id":"c376c1","input":"","pos":66,"type":"cell"}
{"cell_type":"code","id":"c4b182","input":"","pos":2,"type":"cell"}
{"cell_type":"code","id":"cda272","input":"","pos":165,"type":"cell"}
{"cell_type":"code","id":"d7cadd","input":"","pos":178,"type":"cell"}
{"cell_type":"code","id":"d9a045","input":"","pos":10,"type":"cell"}
{"cell_type":"code","id":"da3261","input":"","pos":176,"type":"cell"}
{"cell_type":"code","id":"de1b97","input":"","pos":31,"type":"cell"}
{"cell_type":"code","id":"e5060e","input":"","pos":164,"type":"cell"}
{"cell_type":"code","id":"e6100a","input":"","pos":167,"type":"cell"}
{"cell_type":"code","id":"e6b96e","input":"","pos":17,"type":"cell"}
{"cell_type":"code","id":"ea4192","input":"","pos":103,"type":"cell"}
{"cell_type":"code","id":"eaa7fa","input":"","pos":16,"type":"cell"}
{"cell_type":"code","id":"eb1172","input":"","pos":81,"type":"cell"}
{"cell_type":"code","id":"f34b06","input":"","pos":87,"type":"cell"}
{"cell_type":"code","id":"f95af9","input":"","pos":15,"type":"cell"}
{"cell_type":"code","id":"f9804b","input":"","pos":34,"type":"cell"}
{"cell_type":"code","id":"fa2b3a","input":"","pos":153,"type":"cell"}
{"cell_type":"code","id":"ff3350","input":"","pos":33,"type":"cell"}
{"id":"2b4314","input":"","pos":184,"type":"cell"}
{"id":"2dc7ef","input":"","pos":186,"type":"cell"}
{"id":"530b0e","input":"","pos":180,"type":"cell"}
{"id":"6bb0a7","input":"","pos":185,"type":"cell"}
{"id":"796b67","input":"","pos":182,"type":"cell"}
{"id":"b21f42","input":"","pos":179,"type":"cell"}
{"id":"ba25c5","input":"","pos":181,"type":"cell"}
{"id":"d4e187","input":"","pos":183,"type":"cell"}
{"id":0,"time":1660927060057,"type":"user"}
{"last_load":1660927059940,"type":"file"}