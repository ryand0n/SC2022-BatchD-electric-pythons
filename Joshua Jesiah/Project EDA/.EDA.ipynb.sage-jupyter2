{"backend_state":"init","connection_file":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/.local/share/jupyter/runtime/kernel-2c81939f-f378-45b7-8d87-95ee97ed4658.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"040e5a","input":"","pos":21,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"0940cc","input":"","pos":6,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"0b933c","input":"","pos":176,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"109f08","input":"","pos":197,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"159137","input":"","pos":96,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"16b339","input":"","pos":43,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"18bc60","input":"","pos":157,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"1c1bfa","input":"","pos":50,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2b4314","input":"","pos":187,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2b9a75","input":"","pos":190,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2dc7ef","input":"","pos":189,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2f35c2","input":"","pos":100,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"335c51","input":"","pos":95,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"36bb58","input":"","pos":174,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"3a2654","input":"","pos":91,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"3e0c47","input":"","pos":14,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"3ed358","input":"","pos":193,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"492bc1","input":"","pos":191,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"530b0e","input":"","pos":183,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"53f52e","input":"","pos":104,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"557b3b","input":"","pos":178,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5d1418","input":"","pos":119,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5e7ac4","input":"","pos":194,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"6027ee","input":"","pos":180,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"6bb0a7","input":"","pos":188,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"70815d","input":"","pos":4,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"750be2","input":"","pos":172,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"796b67","input":"","pos":185,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"799ef8","input":"","pos":101,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"7af958","input":"","pos":58,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"806c7d","input":"","pos":175,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"80a583","input":"","pos":144,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"8711fc","input":"","pos":63,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"8a42d0","input":"","pos":192,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"8daad8","input":"","pos":160,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"9045f9","input":"","pos":33,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"935370","input":"","pos":27,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"93fdd4","input":"","pos":165,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"95200d","input":"","pos":195,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"987a8e","input":"","pos":169,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"99e966","input":"","pos":82,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"9c8ffb","input":"","pos":122,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a17197","input":"\n","pos":92,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a1dcf4","input":"","pos":9,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a2c269","input":"","pos":94,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a8de87","input":"","pos":15,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ae649e","input":"","pos":118,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"af2221","input":"","pos":161,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"b21f42","input":"","pos":182,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"b24ae0","input":"","pos":47,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"b2b40e","input":"","pos":159,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"b72b66","input":"","pos":164,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"b9ab30","input":"","pos":177,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ba25c5","input":"","pos":184,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ba5dfb","input":"","pos":105,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"bbdc9e","input":"","pos":132,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"c376c1","input":"","pos":69,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"c4b182","input":"","pos":2,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"d4e187","input":"","pos":186,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"d70dfd","input":"","pos":7,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"d7cadd","input":"","pos":181,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"d9a045","input":"","pos":13,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"da3261","input":"","pos":179,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"de1b97","input":"","pos":34,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"e124e7","input":"","pos":8,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"e5060e","input":"","pos":167,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"e6b96e","input":"","pos":20,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ea4192","input":"","pos":106,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"eaa7fa","input":"","pos":19,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"eb1172","input":"","pos":84,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"f34b06","input":"","pos":90,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"f95af9","input":"","pos":18,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"f9804b","input":"","pos":37,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"fa2b3a","input":"","pos":156,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"fcfc91","input":"","pos":196,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ff3350","input":"","pos":36,"type":"cell"}
{"cell_type":"code","exec_count":197,"id":"706a0b","input":"import pandas as pd\nimport numpy as np\nimport plotly.express as px","pos":0,"type":"cell"}
{"cell_type":"code","exec_count":200,"id":"c2422f","input":"import plotly.graph_objects as go\n\nlabels = ['Oxygen','Hydrogen','Carbon_Dioxide','Nitrogen']\nvalues = [4500, 2500, 1053, 500]\n\n# Use `hole` to create a donut-like pie chart\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.3)])\nfig.show()","output":{"0":{"data":{"iframe":"e9aed431372401d294221e8b536d74b11bc5fee8"},"exec_count":200,"output_type":"execute_result"}},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":206,"id":"8e3a75","input":"fig = px.bar(df, x ='sudden weight loss', color ='Gender')\nfig.show()","output":{"0":{"data":{"iframe":"2c0ad4433d07401b6c7b866c329257ebc343f297"},"exec_count":206,"output_type":"execute_result"}},"pos":1,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":207,"id":"1f9786","input":"fig = px.histogram(df, x ='visual blurring', color ='Gender',\n                  color_discrete_sequence=['lightgreen'])\nfig.show()","output":{"0":{"data":{"iframe":"de805522e130b5e37eed6214481098e20efdcf38"},"exec_count":207,"output_type":"execute_result"}},"pos":3,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":210,"id":"390b5c","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Alopecia', names='class', color='class', title= 'Sudden Weight Loss correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","output":{"0":{"data":{"iframe":"6ae38815fb4a098db644b313e3da6cddc29b44f2"},"exec_count":210,"output_type":"execute_result"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":211,"id":"f05cdd","input":"import plotly.express as px\n# This dataframe has 244 lines, but 4 distinct values for `day`\nDF = df\nfig = px.pie(DF, values='Polyphagia', names='class', color= 'class', title= 'Polyphagia correlation with Diabetes', hole= .5,\n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","output":{"0":{"data":{"iframe":"eafe3e6afeab75f67325bfbc7eaffb3d25fda67e"},"exec_count":211,"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":212,"id":"52cad1","input":"import plotly.express as px\nDF = df\nfig = px.pie(DF, values='visual blurring', names='class',color= 'class', title= 'Visual Blurring correlation with Diabetes', hole= .5, \n             color_discrete_map = {1: 'royalblue', \n                                   0: 'turquoise'})\nfig.show()","output":{"0":{"data":{"iframe":"0485a2ab12ddee26ed54fbfce4d9f878ae7955cd"},"exec_count":212,"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":213,"id":"95eb17","input":"df = pd.read_csv('diabetes_data_upload.csv')","pos":16,"type":"cell"}
{"cell_type":"code","exec_count":214,"id":"34fddf","input":"df.head()","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>weakness</th>\n      <th>Polyphagia</th>\n      <th>Genital thrush</th>\n      <th>visual blurring</th>\n      <th>Itching</th>\n      <th>Irritability</th>\n      <th>delayed healing</th>\n      <th>partial paresis</th>\n      <th>muscle stiffness</th>\n      <th>Alopecia</th>\n      <th>Obesity</th>\n      <th>class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>58</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>41</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>45</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>No</td>\n      <td>Positive</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>60</td>\n      <td>Male</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>Positive</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   Age Gender Polyuria Polydipsia sudden weight loss weakness Polyphagia  \\\n0   40   Male       No        Yes                 No      Yes         No   \n1   58   Male       No         No                 No      Yes         No   \n2   41   Male      Yes         No                 No      Yes        Yes   \n3   45   Male       No         No                Yes      Yes        Yes   \n4   60   Male      Yes        Yes                Yes      Yes        Yes   \n\n  Genital thrush visual blurring Itching Irritability delayed healing  \\\n0             No              No     Yes           No             Yes   \n1             No             Yes      No           No              No   \n2             No              No     Yes           No             Yes   \n3            Yes              No     Yes           No             Yes   \n4             No             Yes     Yes          Yes             Yes   \n\n  partial paresis muscle stiffness Alopecia Obesity     class  \n0              No              Yes      Yes     Yes  Positive  \n1             Yes               No      Yes      No  Positive  \n2              No              Yes      Yes      No  Positive  \n3              No               No       No      No  Positive  \n4             Yes              Yes      Yes     Yes  Positive  "},"exec_count":214,"output_type":"execute_result"}},"pos":17,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":215,"id":"55296e","input":"Visual Blurring \n\n\nWhat is Visual Blurring -  A visual symptom that makes it difficult to see clearly or sharply\n\n\nHow does this symptom relate to diabetes -  If your blood sugar levels change quickly from low to normal, the shape of your eye's lens' can be affected, and your vision can be blurred.\n\n\nWhat is the effect - Blurry or wavy vision in the center of your field of vision","output":{"0":{"ename":"SyntaxError","evalue":"invalid syntax (3535386915.py, line 1)","output_type":"error","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [215]\u001b[0;36m\u001b[0m\n\u001b[0;31m    Visual Blurring\u001b[0m\n\u001b[0m           ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}},"pos":22,"type":"cell"}
{"cell_type":"code","exec_count":216,"id":"db3b19","input":"df['Age'].isnull().values.any()","output":{"0":{"data":{"text/plain":"False"},"exec_count":216,"output_type":"execute_result"}},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":217,"id":"e67a7b","input":"results = []\nfor col in df.columns:\n    missing_or_not = df[col].isnull().values.any()\n    print(col + ' ' + str(missing_or_not))","output":{"0":{"name":"stdout","output_type":"stream","text":"Age False\nGender False\nPolyuria False\nPolydipsia False\nsudden weight loss False\nweakness False\nPolyphagia False\nGenital thrush False\nvisual blurring False\nItching False\nIrritability False\ndelayed healing False\npartial paresis False\nmuscle stiffness False\nAlopecia False\nObesity False\nclass False\n"}},"pos":24,"type":"cell"}
{"cell_type":"code","exec_count":218,"id":"77f8cb","input":"def Change_to_Value (Input):\n    if Input == 'Yes':\n        return 1\n    else:\n        return 0","pos":25,"type":"cell"}
{"cell_type":"code","exec_count":219,"id":"91a3e2","input":"Change_to_Value('No')","output":{"0":{"data":{"text/plain":"0"},"exec_count":219,"output_type":"execute_result"}},"pos":26,"type":"cell"}
{"cell_type":"code","exec_count":220,"id":"57e860","input":"def convert(x):\n    if x == 'Yes' or x == 'Male' or x == 'Positive':\n        return 1\n    else:\n        return 0\n","pos":28,"type":"cell"}
{"cell_type":"code","exec_count":221,"id":"da3e0f","input":"convert('Male')","output":{"0":{"data":{"text/plain":"1"},"exec_count":221,"output_type":"execute_result"}},"pos":29,"type":"cell"}
{"cell_type":"code","exec_count":222,"id":"5a5cdb","input":"df['Gender'].apply(convert)","output":{"0":{"data":{"text/plain":"0      1\n1      1\n2      1\n3      1\n4      1\n      ..\n515    0\n516    0\n517    0\n518    0\n519    1\nName: Gender, Length: 520, dtype: int64"},"exec_count":222,"output_type":"execute_result"}},"pos":30,"type":"cell"}
{"cell_type":"code","exec_count":223,"id":"66d53c","input":"df['Gender']","output":{"0":{"data":{"text/plain":"0        Male\n1        Male\n2        Male\n3        Male\n4        Male\n        ...  \n515    Female\n516    Female\n517    Female\n518    Female\n519      Male\nName: Gender, Length: 520, dtype: object"},"exec_count":223,"output_type":"execute_result"}},"pos":31,"type":"cell"}
{"cell_type":"code","exec_count":224,"id":"daa5f9","input":"for col in df.columns:\n    if col != 'Age':\n        df[col] = df[col].apply(convert)","pos":32,"type":"cell"}
{"cell_type":"code","exec_count":225,"id":"5c2ae7","input":"X = df.drop(['class'], axis = 1)\nY = df['class']","pos":35,"type":"cell"}
{"cell_type":"code","exec_count":226,"id":"199507","input":"X = df.drop(['class'], axis = 1)\nY = df['class']","pos":38,"type":"cell"}
{"cell_type":"code","exec_count":227,"id":"df7b22","input":"X.corrwith(Y)","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\ndtype: float64"},"exec_count":227,"output_type":"execute_result"}},"pos":39,"type":"cell"}
{"cell_type":"code","exec_count":228,"id":"e90e57","input":"corr = df.corr()","pos":40,"type":"cell"}
{"cell_type":"code","exec_count":229,"id":"668449","input":"corr = df.corr()\ncorr['class']","output":{"0":{"data":{"text/plain":"Age                   0.108679\nGender               -0.449233\nPolyuria              0.665922\nPolydipsia            0.648734\nsudden weight loss    0.436568\nweakness              0.243275\nPolyphagia            0.342504\nGenital thrush        0.110288\nvisual blurring       0.251300\nItching              -0.013384\nIrritability          0.299467\ndelayed healing       0.046980\npartial paresis       0.432288\nmuscle stiffness      0.122474\nAlopecia             -0.267512\nObesity               0.072173\nclass                 1.000000\nName: class, dtype: float64"},"exec_count":229,"output_type":"execute_result"}},"pos":41,"type":"cell"}
{"cell_type":"code","exec_count":231,"id":"d413b2","input":"corr_data = X.corrwith(Y).to_frame().reset_index()\nfig = px.bar(corr_data, x='index', y=0, title=\"Correlation between Features and Having Diabetes\")\nfig.show()\n","output":{"0":{"data":{"iframe":"80d5332540f3cc842f50163bc3081dec6fad27e2"},"exec_count":231,"output_type":"execute_result"}},"pos":44,"type":"cell"}
{"cell_type":"code","exec_count":232,"id":"0f7e8c","input":"X = df.drop(['class', 'Age', 'weakness', 'Genital thrush', 'Itching', 'delayed healing', 'muscle stiffness', 'Obesity'], axis = 1)\ny = df['class']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state = 42)\n\n\n\n","pos":45,"type":"cell"}
{"cell_type":"code","exec_count":233,"id":"be5467","input":"from sklearn.preprocessing import StandardScaler\nss = StandardScaler()\nX_train = ss.fit_transform(X_train)\nX_test = ss.transform(X_test)\n\n","pos":46,"type":"cell"}
{"cell_type":"code","exec_count":234,"id":"899aa5","input":"# Logistic Regression","pos":48,"type":"cell"}
{"cell_type":"code","exec_count":235,"id":"b5b0f2","input":"from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\n","pos":49,"type":"cell"}
{"cell_type":"code","exec_count":236,"id":"668510","input":"clf = LogisticRegression(random_state=0).fit(X, y)","pos":51,"type":"cell"}
{"cell_type":"code","exec_count":237,"id":"85b127","input":"y_hat = clf.predict(x_test)\ny_hat","output":{"0":{"data":{"text/plain":"array([1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1,\n       0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1,\n       1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0,\n       0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1,\n       0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1,\n       1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0])"},"exec_count":237,"output_type":"execute_result"}},"pos":52,"type":"cell"}
{"cell_type":"code","exec_count":238,"id":"4d1688","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.5461538461538461\n"}},"pos":53,"type":"cell"}
{"cell_type":"code","exec_count":239,"id":"277cc0","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":239,"output_type":"execute_result"},"1":{"data":{"image/png":"3007dbb0841e1797be000d201b8e9e72db7a318f","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":239,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":54,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":240,"id":"526811","input":"#precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","output":{"0":{"data":{"text/plain":"array([0.30434783, 0.53571429])"},"exec_count":240,"output_type":"execute_result"}},"pos":55,"type":"cell"}
{"cell_type":"code","exec_count":241,"id":"70f56b","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","output":{"0":{"data":{"text/plain":"59"},"exec_count":241,"output_type":"execute_result"}},"pos":56,"type":"cell"}
{"cell_type":"code","exec_count":242,"id":"d9a665","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","output":{"0":{"data":{"text/plain":"array([0.26415094, 0.58441558])"},"exec_count":242,"output_type":"execute_result"}},"pos":57,"type":"cell"}
{"cell_type":"code","exec_count":243,"id":"625ddf","input":"# svm linear","pos":59,"type":"cell"}
{"cell_type":"code","exec_count":244,"id":"1434fa","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification","pos":60,"type":"cell"}
{"cell_type":"code","exec_count":245,"id":"f656c1","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nclf.fit(X, y)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-9 {color: black;background-color: white;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-9\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-23\" type=\"checkbox\" ><label for=\"sk-estimator-id-23\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),\n                (&#x27;linearsvc&#x27;, LinearSVC(random_state=0, tol=1e-05))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-24\" type=\"checkbox\" ><label for=\"sk-estimator-id-24\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">StandardScaler</label><div class=\"sk-toggleable__content\"><pre>StandardScaler()</pre></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-25\" type=\"checkbox\" ><label for=\"sk-estimator-id-25\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC(random_state=0, tol=1e-05)</pre></div></div></div></div></div></div></div>","text/plain":"Pipeline(steps=[('standardscaler', StandardScaler()),\n                ('linearsvc', LinearSVC(random_state=0, tol=1e-05))])"},"exec_count":245,"output_type":"execute_result"}},"pos":61,"type":"cell"}
{"cell_type":"code","exec_count":246,"id":"260e1f","input":"y_hat = clf.predict(x_test)\ny_hat","output":{"0":{"data":{"text/plain":"array([1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1,\n       0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1,\n       1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1,\n       0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1,\n       0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1,\n       1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0])"},"exec_count":246,"output_type":"execute_result"}},"pos":62,"type":"cell"}
{"cell_type":"code","exec_count":247,"id":"e727d7","input":"#Compute your MSE.\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.5230769230769231\n"}},"pos":64,"type":"cell"}
{"cell_type":"code","exec_count":248,"id":"28ed9e","input":"#Create a confusion matrix\nfrom sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":248,"output_type":"execute_result"},"1":{"data":{"image/png":"5eb31b6c248616fca361fb8bd94bd715889afafd","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":248,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":65,"type":"cell"}
{"cell_type":"code","exec_count":249,"id":"694191","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","output":{"0":{"data":{"text/plain":"array([0.30434783, 0.57142857])"},"exec_count":249,"output_type":"execute_result"}},"pos":66,"type":"cell"}
{"cell_type":"code","exec_count":250,"id":"90e984","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","output":{"0":{"data":{"text/plain":"62"},"exec_count":250,"output_type":"execute_result"}},"pos":67,"type":"cell"}
{"cell_type":"code","exec_count":251,"id":"9449b5","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","output":{"0":{"data":{"text/plain":"array([0.28, 0.6 ])"},"exec_count":251,"output_type":"execute_result"}},"pos":68,"type":"cell"}
{"cell_type":"code","exec_count":252,"id":"1ba837","input":"#KNN","pos":70,"type":"cell"}
{"cell_type":"code","exec_count":253,"id":"fd46d6","input":"import sklearn #our favorite machine learning library\nfrom sklearn.neighbors import KNeighborsClassifier as KNN #this will import our model as KNN","pos":71,"type":"cell"}
{"cell_type":"code","exec_count":254,"id":"0eab4e","input":"# Creating the KNN model object -- we need to tell it the number of neighbors to look at.\nk = 7 #number of neighbors to look at (look at 7 nearest neighbors)\nmy_KNN_model = KNN(n_neighbors=k)","pos":72,"type":"cell"}
{"cell_type":"code","exec_count":255,"id":"a116e9","input":"my_KNN_model.fit(x_train, y_train) #train the model on our past results x_train (inputs) and y_train (outputs)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-10 {color: black;background-color: white;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-10\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier(n_neighbors=7)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-26\" type=\"checkbox\" checked><label for=\"sk-estimator-id-26\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier(n_neighbors=7)</pre></div></div></div></div></div>","text/plain":"KNeighborsClassifier(n_neighbors=7)"},"exec_count":255,"output_type":"execute_result"}},"pos":73,"type":"cell"}
{"cell_type":"code","exec_count":256,"id":"ad15a6","input":"y_hat = my_KNN_model.predict(x_test)","pos":74,"type":"cell"}
{"cell_type":"code","exec_count":257,"id":"15e4c1","input":"y_hat","output":{"0":{"data":{"text/plain":"array([1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1,\n       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,\n       1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n       1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1,\n       1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0,\n       0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1])"},"exec_count":257,"output_type":"execute_result"}},"pos":75,"type":"cell"}
{"cell_type":"code","exec_count":258,"id":"b5c596","input":"np.array(y_test)","output":{"0":{"data":{"text/plain":"array([0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1,\n       1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,\n       0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,\n       0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0])"},"exec_count":258,"output_type":"execute_result"}},"pos":76,"type":"cell"}
{"cell_type":"code","exec_count":259,"id":"a03838","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","output":{"0":{"name":"stdout","output_type":"stream","text":"0.38461538461538464\n"}},"pos":77,"type":"cell"}
{"cell_type":"code","exec_count":260,"id":"3781ed","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":260,"output_type":"execute_result"},"1":{"data":{"image/png":"6e3e26be626abc94a37241a053dec0c9506d6403","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":260,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":78,"type":"cell"}
{"cell_type":"code","exec_count":261,"id":"075f7d","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","output":{"0":{"data":{"text/plain":"array([0.2826087 , 0.79761905])"},"exec_count":261,"output_type":"execute_result"}},"pos":79,"type":"cell"}
{"cell_type":"code","exec_count":262,"id":"54c259","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","output":{"0":{"data":{"text/plain":"80"},"exec_count":262,"output_type":"execute_result"}},"pos":80,"type":"cell"}
{"cell_type":"code","exec_count":263,"id":"67961a","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","output":{"0":{"data":{"text/plain":"array([0.43333333, 0.67      ])"},"exec_count":263,"output_type":"execute_result"}},"pos":81,"type":"cell"}
{"cell_type":"code","exec_count":264,"id":"5d5b35","input":"from sklearn.svm import SVC\nfrom sklearn.model_selection import StratifiedShuffleSplit\nfrom sklearn.model_selection import GridSearchCV","pos":83,"type":"cell"}
{"cell_type":"code","exec_count":265,"id":"0a62e2","input":"#RBF","pos":85,"type":"cell"}
{"cell_type":"code","exec_count":266,"id":"563984","input":"import matplotlib.pyplot as plt\n\nplt.figure(figsize=(8, 6))\nfrom sklearn.metrics import confusion_matrix\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":266,"output_type":"execute_result"},"1":{"data":{"image/png":"6e3e26be626abc94a37241a053dec0c9506d6403","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":266,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":86,"type":"cell"}
{"cell_type":"code","exec_count":267,"id":"56f823","input":"# precision\nfrom sklearn.metrics import precision_score\nprecision_score(y_hat, y_test,  average=None)\n","output":{"0":{"data":{"text/plain":"array([0.2826087 , 0.79761905])"},"exec_count":267,"output_type":"execute_result"}},"pos":87,"type":"cell"}
{"cell_type":"code","exec_count":268,"id":"ad7e92","input":"# accuracy\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_hat, y_test, normalize=False)","output":{"0":{"data":{"text/plain":"80"},"exec_count":268,"output_type":"execute_result"}},"pos":88,"type":"cell"}
{"cell_type":"code","exec_count":269,"id":"729a4a","input":"# recall\nfrom sklearn.metrics import recall_score\nrecall_score(y_hat, y_test, average=None)","output":{"0":{"data":{"text/plain":"array([0.43333333, 0.67      ])"},"exec_count":269,"output_type":"execute_result"}},"pos":89,"type":"cell"}
{"cell_type":"code","exec_count":270,"id":"682080","input":"#Logistic regression\n#svmrbf and svm linear\n#knn\n#naive bayes\n#Decision trees\n#Random forest\n\nprecision, accuracy, recall","output":{"0":{"ename":"NameError","evalue":"name 'precision' is not defined","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","Input \u001b[0;32mIn [270]\u001b[0m, in \u001b[0;36m<cell line: 8>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m#Logistic regression\u001b[39;00m\n\u001b[1;32m      2\u001b[0m \u001b[38;5;66;03m#svmrbf and svm linear\u001b[39;00m\n\u001b[1;32m      3\u001b[0m \u001b[38;5;66;03m#knn\u001b[39;00m\n\u001b[1;32m      4\u001b[0m \u001b[38;5;66;03m#naive bayes\u001b[39;00m\n\u001b[1;32m      5\u001b[0m \u001b[38;5;66;03m#Decision trees\u001b[39;00m\n\u001b[1;32m      6\u001b[0m \u001b[38;5;66;03m#Random forest\u001b[39;00m\n\u001b[0;32m----> 8\u001b[0m \u001b[43mprecision\u001b[49m, accuracy, recall\n","\u001b[0;31mNameError\u001b[0m: name 'precision' is not defined"]}},"pos":93,"type":"cell"}
{"cell_type":"code","exec_count":271,"id":"50e1e3","input":"import sklearn\nfrom sklearn.model_selection import train_test_split\n\nx_train, x_test ,y_train, y_test = train_test_split(X, Y)\n","pos":97,"type":"cell"}
{"cell_type":"code","exec_count":272,"id":"d8c2cb","input":"print(x_train.shape)\nprint(x_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","output":{"0":{"name":"stdout","output_type":"stream","text":"(390, 9)\n(130, 9)\n(390,)\n(130,)\n"}},"pos":98,"type":"cell"}
{"cell_type":"code","exec_count":273,"id":"d222c3","input":"x_test.head()","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>Polyphagia</th>\n      <th>visual blurring</th>\n      <th>Irritability</th>\n      <th>partial paresis</th>\n      <th>Alopecia</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>83</th>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>143</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>102</th>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>261</th>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>91</th>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"     Gender  Polyuria  Polydipsia  sudden weight loss  Polyphagia  \\\n83        0         1           1                   0           0   \n143       1         1           0                   1           0   \n102       0         0           1                   1           0   \n261       1         1           1                   1           0   \n91        0         1           1                   1           1   \n\n     visual blurring  Irritability  partial paresis  Alopecia  \n83                 1             0                1         0  \n143                0             0                1         0  \n102                1             0                0         1  \n261                0             1                1         0  \n91                 1             1                1         0  "},"exec_count":273,"output_type":"execute_result"}},"pos":99,"type":"cell"}
{"cell_type":"code","exec_count":274,"id":"a46f63","input":" y_train.head()","output":{"0":{"data":{"text/plain":"467    0\n428    1\n85     1\n489    0\n245    0\nName: class, dtype: int64"},"exec_count":274,"output_type":"execute_result"}},"pos":102,"type":"cell"}
{"cell_type":"code","exec_count":275,"id":"3561f8","input":"y_test.head","output":{"0":{"data":{"text/plain":"<bound method NDFrame.head of 83     1\n143    1\n102    1\n261    1\n91     1\n      ..\n222    0\n453    1\n497    0\n445    1\n283    0\nName: class, Length: 130, dtype: int64>"},"exec_count":275,"output_type":"execute_result"}},"pos":103,"type":"cell"}
{"cell_type":"code","exec_count":276,"id":"05281a","input":"#KNN","pos":107,"type":"cell"}
{"cell_type":"code","exec_count":277,"id":"9da828","input":"import sklearn #our favorite machine learning library\nfrom sklearn.neighbors import KNeighborsClassifier as KNN #this will import our model as KNN\nfrom sklearn.model_selection import GridSearchCV","pos":108,"type":"cell"}
{"cell_type":"code","exec_count":278,"id":"6ae3bf","input":"# Creating the KNN model object -- we need to tell it the number of neighbors to look at.\nk = 7 #number of neighbors to look at (look at 7 nearest neighbors)\nparameters = {'n_neighbors':[3, 5, 7], 'weights': ('uniform', 'distance'), 'algorithm': ('auto', 'ball_tree')}\nmy_KNN_model = KNN()","pos":109,"type":"cell"}
{"cell_type":"code","exec_count":279,"id":"5c7940","input":"clf = GridSearchCV(my_KNN_model, parameters)","pos":110,"type":"cell"}
{"cell_type":"code","exec_count":280,"id":"6b3712","input":"clf.fit(x_train, y_train)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-11 {color: black;background-color: white;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-11\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-27\" type=\"checkbox\" ><label for=\"sk-estimator-id-27\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={&#x27;algorithm&#x27;: (&#x27;auto&#x27;, &#x27;ball_tree&#x27;),\n                         &#x27;n_neighbors&#x27;: [3, 5, 7],\n                         &#x27;weights&#x27;: (&#x27;uniform&#x27;, &#x27;distance&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-28\" type=\"checkbox\" ><label for=\"sk-estimator-id-28\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-29\" type=\"checkbox\" ><label for=\"sk-estimator-id-29\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=KNeighborsClassifier(),\n             param_grid={'algorithm': ('auto', 'ball_tree'),\n                         'n_neighbors': [3, 5, 7],\n                         'weights': ('uniform', 'distance')})"},"exec_count":280,"output_type":"execute_result"}},"pos":111,"type":"cell"}
{"cell_type":"code","exec_count":281,"id":"a96c03","input":"clf.best_params_","output":{"0":{"data":{"text/plain":"{'algorithm': 'auto', 'n_neighbors': 5, 'weights': 'distance'}"},"exec_count":281,"output_type":"execute_result"}},"pos":112,"type":"cell"}
{"cell_type":"code","exec_count":282,"id":"76c2dc","input":"clf.best_score_","output":{"0":{"data":{"text/plain":"0.9358974358974359"},"exec_count":282,"output_type":"execute_result"}},"pos":113,"type":"cell"}
{"cell_type":"code","exec_count":283,"id":"6f471c","input":"pred = clf.predict(x_test)","pos":114,"type":"cell"}
{"cell_type":"code","exec_count":284,"id":"56b222","input":"(pred == y_test).mean()","output":{"0":{"data":{"text/plain":"0.9461538461538461"},"exec_count":284,"output_type":"execute_result"}},"pos":115,"type":"cell"}
{"cell_type":"code","exec_count":285,"id":"2775f9","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","output":{"0":{"name":"stdout","output_type":"stream","text":"0.49230769230769234\n"}},"pos":116,"type":"cell"}
{"cell_type":"code","exec_count":286,"id":"d28d0f","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":286,"output_type":"execute_result"},"1":{"data":{"image/png":"b30e1dc07c923138adfd2ecc152573825a040218","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":286,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":117,"type":"cell"}
{"cell_type":"code","exec_count":287,"id":"def998","input":"#SVM linear","pos":120,"type":"cell"}
{"cell_type":"code","exec_count":288,"id":"d9bc80","input":"from sklearn.svm import LinearSVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.datasets import make_classification\nfrom sklearn.model_selection import GridSearchCV","pos":121,"type":"cell"}
{"cell_type":"code","exec_count":289,"id":"abfa55","input":"clf = make_pipeline(StandardScaler(),LinearSVC(random_state=0, tol=1e-5))\nparameters = {'penalty': ('l1', 'l2'),'loss':('hinge','squared_hinge'), 'multi_class':('ovr', 'crammer_singer')}\nmy_svm_model = LinearSVC()\n","pos":123,"type":"cell"}
{"cell_type":"code","exec_count":290,"id":"7a386e","input":"clf = GridSearchCV(my_svm_model, parameters)","pos":124,"type":"cell"}
{"cell_type":"code","exec_count":291,"id":"6d733b","input":"clf.fit(x_train, y_train)","output":{"0":{"name":"stderr","output_type":"stream","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n10 fits failed out of a total of 40.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='hinge' is not supported, Parameters: penalty='l1', loss='hinge', dual=True\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_classes.py\", line 257, in fit\n    self.coef_, self.intercept_, n_iter_ = _fit_liblinear(\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1204, in _fit_liblinear\n    solver_type = _get_liblinear_solver_type(multi_class, penalty, loss, dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/svm/_base.py\", line 1043, in _get_liblinear_solver_type\n    raise ValueError(\nValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='squared_hinge' are not supported when dual=True, Parameters: penalty='l1', loss='squared_hinge', dual=True\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan 0.90769231 0.91538462 0.91538462        nan 0.90512821\n 0.91025641 0.91538462]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-12 {color: black;background-color: white;}#sk-container-id-12 pre{padding: 0;}#sk-container-id-12 div.sk-toggleable {background-color: white;}#sk-container-id-12 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-12 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-12 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-12 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-12 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-12 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-12 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-12 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-12 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-12 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-12 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-12 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-12 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-12 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-12 div.sk-item {position: relative;z-index: 1;}#sk-container-id-12 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-12 div.sk-item::before, #sk-container-id-12 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-12 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-12 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-12 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-12 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-12 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-12 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-12 div.sk-label-container {text-align: center;}#sk-container-id-12 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-12 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-12\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-30\" type=\"checkbox\" ><label for=\"sk-estimator-id-30\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LinearSVC(),\n             param_grid={&#x27;loss&#x27;: (&#x27;hinge&#x27;, &#x27;squared_hinge&#x27;),\n                         &#x27;multi_class&#x27;: (&#x27;ovr&#x27;, &#x27;crammer_singer&#x27;),\n                         &#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-31\" type=\"checkbox\" ><label for=\"sk-estimator-id-31\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-32\" type=\"checkbox\" ><label for=\"sk-estimator-id-32\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearSVC</label><div class=\"sk-toggleable__content\"><pre>LinearSVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LinearSVC(),\n             param_grid={'loss': ('hinge', 'squared_hinge'),\n                         'multi_class': ('ovr', 'crammer_singer'),\n                         'penalty': ('l1', 'l2')})"},"exec_count":291,"output_type":"execute_result"}},"pos":125,"type":"cell"}
{"cell_type":"code","exec_count":292,"id":"306f0d","input":"clf.best_params_","output":{"0":{"data":{"text/plain":"{'loss': 'hinge', 'multi_class': 'crammer_singer', 'penalty': 'l1'}"},"exec_count":292,"output_type":"execute_result"}},"pos":126,"type":"cell"}
{"cell_type":"code","exec_count":293,"id":"2be201","input":"clf.best_score_","output":{"0":{"data":{"text/plain":"0.9153846153846154"},"exec_count":293,"output_type":"execute_result"}},"pos":127,"type":"cell"}
{"cell_type":"code","exec_count":294,"id":"c90615","input":"pred = clf.predict(x_test)","pos":128,"type":"cell"}
{"cell_type":"code","exec_count":295,"id":"651505","input":"(pred == y_test).mean()","output":{"0":{"data":{"text/plain":"0.8692307692307693"},"exec_count":295,"output_type":"execute_result"}},"pos":129,"type":"cell"}
{"cell_type":"code","exec_count":296,"id":"ab39af","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\n","output":{"0":{"name":"stdout","output_type":"stream","text":"0.49230769230769234\n"}},"pos":130,"type":"cell"}
{"cell_type":"code","exec_count":297,"id":"fbaca7","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":297,"output_type":"execute_result"},"1":{"data":{"image/png":"b30e1dc07c923138adfd2ecc152573825a040218","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":297,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":131,"type":"cell"}
{"cell_type":"code","exec_count":298,"id":"9e4995","input":"# Logistic Regression","pos":133,"type":"cell"}
{"cell_type":"code","exec_count":299,"id":"bc72f0","input":"from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV\n","pos":134,"type":"cell"}
{"cell_type":"code","exec_count":300,"id":"9e6a10","input":"clf = LogisticRegression(random_state=0).fit(X, y)\nparameters = {'penalty': ('l1', 'l2', 'elasticnet'), 'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga')}\nmy_LR_model = LogisticRegression()","pos":135,"type":"cell"}
{"cell_type":"code","exec_count":301,"id":"62f91a","input":"clf = GridSearchCV(my_LR_model, parameters)","pos":136,"type":"cell"}
{"cell_type":"code","exec_count":302,"id":"334c66","input":"clf.fit(x_train, y_train)","output":{"0":{"name":"stderr","output_type":"stream","text":"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning:\n\n\n40 fits failed out of a total of 75.\nThe score on these train-test partitions for these parameters will be set to nan.\nIf these failures are not expected, you can try to debug them by setting error_score='raise'.\n\nBelow are more details about the failures:\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got l1 penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver newton-cg supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 71, in _check_solver\n    raise ValueError(\nValueError: Only 'saga' solver supports elasticnet penalty, got solver=liblinear.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1091, in fit\n    solver = _check_solver(self.solver, self.penalty, self.dual)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 61, in _check_solver\n    raise ValueError(\nValueError: Solver sag supports only 'l2' or 'none' penalties, got elasticnet penalty.\n\n--------------------------------------------------------------------------------\n5 fits failed with the following error:\nTraceback (most recent call last):\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_validation.py\", line 686, in _fit_and_score\n    estimator.fit(X_train, y_train, **fit_params)\n  File \"/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py\", line 1101, in fit\n    raise ValueError(\nValueError: l1_ratio must be between 0 and 1; got (l1_ratio=None)\n\n\n/projects/b36ed0b0-d7f5-416a-895a-d63c582b0b71/miniconda3/envs/ds_env/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning:\n\nOne or more of the test scores are non-finite: [       nan        nan 0.9               nan 0.9025641  0.90769231\n 0.90769231 0.90769231 0.90769231 0.90769231        nan        nan\n        nan        nan        nan]\n\n"},"1":{"data":{"text/html":"<style>#sk-container-id-13 {color: black;background-color: white;}#sk-container-id-13 pre{padding: 0;}#sk-container-id-13 div.sk-toggleable {background-color: white;}#sk-container-id-13 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-13 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-13 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-13 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-13 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-13 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-13 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-13 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-13 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-13 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-13 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-13 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-13 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-13 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-13 div.sk-item {position: relative;z-index: 1;}#sk-container-id-13 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-13 div.sk-item::before, #sk-container-id-13 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-13 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-13 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-13 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-13 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-13 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-13 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-13 div.sk-label-container {text-align: center;}#sk-container-id-13 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-13 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-13\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-33\" type=\"checkbox\" ><label for=\"sk-estimator-id-33\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=LogisticRegression(),\n             param_grid={&#x27;penalty&#x27;: (&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;),\n                         &#x27;solver&#x27;: (&#x27;newton-cg&#x27;, &#x27;lbfgs&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;,\n                                    &#x27;saga&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-34\" type=\"checkbox\" ><label for=\"sk-estimator-id-34\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-35\" type=\"checkbox\" ><label for=\"sk-estimator-id-35\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=LogisticRegression(),\n             param_grid={'penalty': ('l1', 'l2', 'elasticnet'),\n                         'solver': ('newton-cg', 'lbfgs', 'liblinear', 'sag',\n                                    'saga')})"},"exec_count":302,"output_type":"execute_result"}},"pos":137,"type":"cell"}
{"cell_type":"code","exec_count":303,"id":"9f5810","input":"clf.best_params_","output":{"0":{"data":{"text/plain":"{'penalty': 'l2', 'solver': 'newton-cg'}"},"exec_count":303,"output_type":"execute_result"}},"pos":138,"type":"cell"}
{"cell_type":"code","exec_count":304,"id":"bc801f","input":"clf.best_score_","output":{"0":{"data":{"text/plain":"0.9076923076923077"},"exec_count":304,"output_type":"execute_result"}},"pos":139,"type":"cell"}
{"cell_type":"code","exec_count":305,"id":"e396c2","input":"pred = clf.predict(x_test)","pos":140,"type":"cell"}
{"cell_type":"code","exec_count":306,"id":"c2b707","input":"(pred == y_test).mean()","output":{"0":{"data":{"text/plain":"0.8692307692307693"},"exec_count":306,"output_type":"execute_result"}},"pos":141,"type":"cell"}
{"cell_type":"code","exec_count":307,"id":"d80b96","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.49230769230769234\n"}},"pos":142,"type":"cell"}
{"cell_type":"code","exec_count":308,"id":"7853ac","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":308,"output_type":"execute_result"},"1":{"data":{"image/png":"b30e1dc07c923138adfd2ecc152573825a040218","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":308,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":143,"type":"cell"}
{"cell_type":"code","exec_count":309,"id":"4aa2ad","input":"# RBF","pos":145,"type":"cell"}
{"cell_type":"code","exec_count":310,"id":"420f58","input":"import numpy as np\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV\n","pos":146,"type":"cell"}
{"cell_type":"code","exec_count":311,"id":"73bb9e","input":"clf = make_pipeline(StandardScaler(),SVC(gamma='auto')).fit(X,y)\nparameters = {'kernel': ('rbf', 'linear'),'decision_function_shape':('ovo', 'ovr')}\nmy_svc_model = SVC()","pos":147,"type":"cell"}
{"cell_type":"code","exec_count":312,"id":"934838","input":"clf = GridSearchCV(my_svc_model, parameters)","pos":148,"type":"cell"}
{"cell_type":"code","exec_count":313,"id":"6567bb","input":"clf.fit(x_train, y_train)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-14 {color: black;background-color: white;}#sk-container-id-14 pre{padding: 0;}#sk-container-id-14 div.sk-toggleable {background-color: white;}#sk-container-id-14 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-14 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-14 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-14 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-14 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-14 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-14 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-14 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-14 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-14 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-14 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-14 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-14 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-14 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-14 div.sk-item {position: relative;z-index: 1;}#sk-container-id-14 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-14 div.sk-item::before, #sk-container-id-14 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-14 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-14 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-14 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-14 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-14 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-14 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-14 div.sk-label-container {text-align: center;}#sk-container-id-14 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-14 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-14\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-36\" type=\"checkbox\" ><label for=\"sk-estimator-id-36\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(estimator=SVC(),\n             param_grid={&#x27;decision_function_shape&#x27;: (&#x27;ovo&#x27;, &#x27;ovr&#x27;),\n                         &#x27;kernel&#x27;: (&#x27;rbf&#x27;, &#x27;linear&#x27;)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-37\" type=\"checkbox\" ><label for=\"sk-estimator-id-37\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-38\" type=\"checkbox\" ><label for=\"sk-estimator-id-38\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"GridSearchCV(estimator=SVC(),\n             param_grid={'decision_function_shape': ('ovo', 'ovr'),\n                         'kernel': ('rbf', 'linear')})"},"exec_count":313,"output_type":"execute_result"}},"pos":149,"type":"cell"}
{"cell_type":"code","exec_count":314,"id":"76063e","input":"clf.best_params_","output":{"0":{"data":{"text/plain":"{'decision_function_shape': 'ovo', 'kernel': 'rbf'}"},"exec_count":314,"output_type":"execute_result"}},"pos":150,"type":"cell"}
{"cell_type":"code","exec_count":315,"id":"b73e43","input":"clf.best_score_","output":{"0":{"data":{"text/plain":"0.9307692307692308"},"exec_count":315,"output_type":"execute_result"}},"pos":151,"type":"cell"}
{"cell_type":"code","exec_count":316,"id":"b6216b","input":"pred = clf.predict(x_test)","pos":152,"type":"cell"}
{"cell_type":"code","exec_count":317,"id":"2c0cc1","input":"(pred == y_test).mean()","output":{"0":{"data":{"text/plain":"0.9384615384615385"},"exec_count":317,"output_type":"execute_result"}},"pos":153,"type":"cell"}
{"cell_type":"code","exec_count":318,"id":"ff0404","input":"total_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.49230769230769234\n"}},"pos":154,"type":"cell"}
{"cell_type":"code","exec_count":319,"id":"d0721c","input":"from sklearn.metrics import confusion_matrix\nplt.figure(figsize=(8, 6))\nimport seaborn as sns\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\n","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":319,"output_type":"execute_result"},"1":{"data":{"image/png":"b30e1dc07c923138adfd2ecc152573825a040218","text/plain":"<Figure size 576x432 with 2 Axes>"},"exec_count":319,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":155,"type":"cell"}
{"cell_type":"code","exec_count":320,"id":"60c240","input":"# Coin Toss\nimport random\nCoin_Sides = ('Heads', 'Tails')\nResult = random.choice(Coin_Sides)\nprint(Result)","output":{"0":{"name":"stdout","output_type":"stream","text":"Tails\n"}},"pos":158,"type":"cell"}
{"cell_type":"code","exec_count":321,"id":"a31134","input":"import plotly.graph_objects as go\n\nlabels = df['Gender','Polyuria','Polydipsia','sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia']\nvalues = df['Gender','Polyuria','Polydipsia','sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia']\n\n# Use `hole` to create a donut-like pie chart\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.3)])\nfig.show()","output":{"0":{"ename":"KeyError","evalue":"('Gender', 'Polyuria', 'Polydipsia', 'sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia')","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","File \u001b[0;32m~/miniconda3/envs/ds_env/lib/python3.8/site-packages/pandas/core/indexes/base.py:3621\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3620\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m-> 3621\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_engine\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcasted_key\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   3622\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n","File \u001b[0;32m~/miniconda3/envs/ds_env/lib/python3.8/site-packages/pandas/_libs/index.pyx:136\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","File \u001b[0;32m~/miniconda3/envs/ds_env/lib/python3.8/site-packages/pandas/_libs/index.pyx:163\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","File \u001b[0;32mpandas/_libs/hashtable_class_helper.pxi:5198\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[0;34m()\u001b[0m\n","File \u001b[0;32mpandas/_libs/hashtable_class_helper.pxi:5206\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[0;34m()\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: ('Gender', 'Polyuria', 'Polydipsia', 'sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia')","\nThe above exception was the direct cause of the following exception:\n","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","Input \u001b[0;32mIn [321]\u001b[0m, in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mplotly\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mgraph_objects\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mgo\u001b[39;00m\n\u001b[0;32m----> 3\u001b[0m labels \u001b[38;5;241m=\u001b[39m \u001b[43mdf\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mGender\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mPolyuria\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mPolydipsia\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43msudden weight loss\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mPolyphagia\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mvisual blurring\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mIrritability\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mpartial paresis\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mAlopecia\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\n\u001b[1;32m      4\u001b[0m values \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mGender\u001b[39m\u001b[38;5;124m'\u001b[39m,\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPolyuria\u001b[39m\u001b[38;5;124m'\u001b[39m,\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPolydipsia\u001b[39m\u001b[38;5;124m'\u001b[39m,\u001b[38;5;124m'\u001b[39m\u001b[38;5;124msudden weight loss\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mPolyphagia\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvisual blurring\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mIrritability\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mpartial paresis\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAlopecia\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[1;32m      6\u001b[0m \u001b[38;5;66;03m# Use `hole` to create a donut-like pie chart\u001b[39;00m\n","File \u001b[0;32m~/miniconda3/envs/ds_env/lib/python3.8/site-packages/pandas/core/frame.py:3505\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m   3503\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m   3504\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[0;32m-> 3505\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcolumns\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   3506\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[1;32m   3507\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n","File \u001b[0;32m~/miniconda3/envs/ds_env/lib/python3.8/site-packages/pandas/core/indexes/base.py:3623\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3621\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine\u001b[38;5;241m.\u001b[39mget_loc(casted_key)\n\u001b[1;32m   3622\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n\u001b[0;32m-> 3623\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[1;32m   3624\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[1;32m   3625\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[1;32m   3626\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[1;32m   3627\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[1;32m   3628\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n","\u001b[0;31mKeyError\u001b[0m: ('Gender', 'Polyuria', 'Polydipsia', 'sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia')"]}},"pos":162,"type":"cell"}
{"cell_type":"code","exec_count":322,"id":"65c6fc","input":"x_test.head()\n","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Gender</th>\n      <th>Polyuria</th>\n      <th>Polydipsia</th>\n      <th>sudden weight loss</th>\n      <th>Polyphagia</th>\n      <th>visual blurring</th>\n      <th>Irritability</th>\n      <th>partial paresis</th>\n      <th>Alopecia</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>83</th>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>143</th>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>102</th>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>261</th>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>91</th>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"     Gender  Polyuria  Polydipsia  sudden weight loss  Polyphagia  \\\n83        0         1           1                   0           0   \n143       1         1           0                   1           0   \n102       0         0           1                   1           0   \n261       1         1           1                   1           0   \n91        0         1           1                   1           1   \n\n     visual blurring  Irritability  partial paresis  Alopecia  \n83                 1             0                1         0  \n143                0             0                1         0  \n102                1             0                0         1  \n261                0             1                1         0  \n91                 1             1                1         0  "},"exec_count":322,"output_type":"execute_result"}},"pos":163,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":323,"id":"bbfb0e","input":"import plotly.express as px\nfig = px.pie(data, values= 'Gender','Polyuria','Polydipsia','sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia')\nfig.show()\n","output":{"0":{"ename":"SyntaxError","evalue":"positional argument follows keyword argument (2691184160.py, line 2)","output_type":"error","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [323]\u001b[0;36m\u001b[0m\n\u001b[0;31m    fig = px.pie(data, values= 'Gender','Polyuria','Polydipsia','sudden weight loss', 'Polyphagia', 'visual blurring', 'Irritability', 'partial paresis', 'Alopecia')\u001b[0m\n\u001b[0m                                        ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m positional argument follows keyword argument\n"]}},"pos":166,"type":"cell"}
{"cell_type":"code","exec_count":324,"id":"77e84e","input":"corr = df.corr()\nfig = px.imshow(corr, aspect=\"auto\", color_continuous_scale='icefire', text_auto = True)\nfig.show()\n\n\n","output":{"0":{"data":{"iframe":"45fa02669d4de58c987f4d2c2e1f2629c4add6f2"},"exec_count":324,"output_type":"execute_result"}},"pos":42,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":326,"id":"cda272","input":"import plotly.express as px\n\nfig = make_subplots(rows=3, cols=3)\n\nfig.append_trace(go.Histogram(name=\"Gender\", x=df['Gender'], y=df['class']),row=1, col=1)\nfig.append_trace(go.Histogram(name='Irritability', x=df['Irritability'], y=df['class']),row=1, col=2)\nfig.append_trace(go.Histogram(name = 'partial paresis', x=df['partial paresis'], y=df['class']),row=1, col=3)\nfig.append_trace(go.Histogram(name = 'sudden weight loss', x=df['sudden weight loss'], y=df['class']), row=2, col=1)\nfig.append_trace(go.Histogram(name = 'Polyphagia', x=df['Polyphagia'], y=df['class']),row=2, \nfig.append_trace(go.Histogram(name = 'Polydipsia', x=df['Polydipsia'], y=df['class']),row=3, col=1)\nfig.append_trace(go.Histogram(name = 'visual blurring', x=df['visual blurring'], y=df['class']), row=3, col=2)\nfig.append_trace(go.Histogram(name = 'Alopecia', x=df['Alopecia'], y=df['class']),row=3, col=3)\n\nfig.update_layout(legend_title_text='Features', title_text='Positive or Negative Features', title_x=0.5)\nfig.show()\n\nfig.write_html(\"histograms.html\")\n","output":{"0":{"ename":"SyntaxError","evalue":"invalid syntax (370548477.py, line 11)","output_type":"error","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [326]\u001b[0;36m\u001b[0m\n\u001b[0;31m    fig.append_trace(go.Histogram(name = 'visual blurring', x=df['visual blurring'], y=df['class']), row=3, col=2)\u001b[0m\n\u001b[0m    ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}},"pos":168,"type":"cell"}
{"cell_type":"code","exec_count":328,"id":"e6100a","input":"library(plotly)\nlibrary(dplyr)\n\n# Get Manufacturer\nmtcarsmanuf <- sapply(strsplit(rownames(mtcars), \" \"), \"[[\", 1)\n\ndf <- mtcars\ndf <- df group_by(manuf)\ndf <- df summarize(count = n())\nfig <- df plot_ly(labels = ~manuf, values = ~count)\nfig <- fig add_pie(hole = 0.6)\nfig <- fig layout(title = \"Donut charts using Plotly\",  showlegend = F,\n                      xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),\n                      yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))\n\nfig","output":{"0":{"ename":"SyntaxError","evalue":"invalid syntax (2104176713.py, line 8)","output_type":"error","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [328]\u001b[0;36m\u001b[0m\n\u001b[0;31m    df <- df %>% group_by(manuf)\u001b[0m\n\u001b[0m              ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}},"pos":170,"type":"cell"}
{"cell_type":"code","exec_count":332,"id":"a17f94","input":"library(plotly)\nlibrary(dplyr)\n\n\nfig  = fig add_pie(data = count(diamonds, cut), labels = ~cut, values = ~n,\n          name = \"Cut\", domain = list(x = c(0, 0.4), y = c(0.4, 1)))\nfig = fig add_pie(data = count(diamonds, color), labels = ~color, values = ~n,\n          name = \"Color\", domain = list(x = c(0.6, 1), y = c(0.4, 1)))\nfig  = fig add_pie(data = count(diamonds, clarity), labels = ~clarity, values = ~n,\n          name = \"Clarity\", domain = list(x = c(0.25, 0.75), y = c(0, 0.6)))\nfig =  fig layout(title = \"Pie Charts with Subplots\", showlegend = F,\n         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),\n         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))\n\nfig.show()","output":{"0":{"ename":"SyntaxError","evalue":"invalid syntax (3463595689.py, line 5)","output_type":"error","traceback":["\u001b[0;36m  Input \u001b[0;32mIn [332]\u001b[0;36m\u001b[0m\n\u001b[0;31m    fig  = fig add_pie(data = count(diamonds, cut), labels = ~cut, values = ~n,\u001b[0m\n\u001b[0m               ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}},"pos":171,"type":"cell"}
{"cell_type":"code","exec_count":333,"id":"bcfac7","input":"import plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\nlabels = df['class']\nspecs = [[{'type':'domain'}, {'type':'domain'}, {'type':'domain'}],[{'type':'domain'}, {'type':'domain'}, {'type':'domain'}], [{'type':'domain'}, {'type':'domain'}, {'type':'domain'}]]\nfig = make_subplots(rows=3, cols=3, specs=specs)\n\nfig.add_trace(go.Pie(labels=labels, values= df['Gender'], name=\"Gender\"),\n              1, 1)\nfig.add_trace(go.Pie(labels=labels, values= df['Alopecia'], name=\"Alopecia\"),\n              1, 2)\nfig.add_trace(go.Pie(labels=labels, values= df['visual blurring'], name=\"visual blurring\"),\n              1, 3)\nfig.add_trace(go.Pie(labels=labels, values= df['Polydipsia'], name=\"Polydipsia\"),\n              2, 1)\nfig.add_trace(go.Pie(labels=labels, values= df['Polyphagia'], name=\"Polyphagia\"),\n              2, 2)\nfig.add_trace(go.Pie(labels=labels, values= df['Polyuria'], name=\"Polyuria\"),\n              2, 3)\nfig.add_trace(go.Pie(labels=labels, values= df['sudden weight loss'], name=\"sudden weight loss\"),\n              3, 1)\nfig.add_trace(go.Pie(labels=labels, values= df['partial paresis'], name=\"partial paresis\"),\n              3, 2)\nfig.add_trace(go.Pie(labels=labels, values= df['Irritability'], name=\"Irritability\"),\n              3, 3)\n\n\n# Use hole to create a donut-like pie chart\nfig.update_traces(hole=.4, hoverinfo=\"percent+name\")\nfig.write_html(\"PIE2.html\")\nfig.show()","output":{"0":{"data":{"iframe":"9879596ad374cd341f9c6b99bde0365fa93431e0"},"exec_count":333,"output_type":"execute_result"}},"pos":173,"type":"cell"}
{"id":0,"time":1661359028905,"type":"user"}
{"last_load":1661359028265,"type":"file"}